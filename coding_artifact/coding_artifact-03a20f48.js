import{r as u,a as ne,R as M,m as ke}from"./assets/vendor-891a2f54.js";import{h as Ie,p as ye}from"./assets/diff2html-520d79da.js";import{H as oe}from"./assets/hljs-c6694249.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();var xe={exports:{}},Q={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Le=u,Re=Symbol.for("react.element"),Be=Symbol.for("react.fragment"),Fe=Object.prototype.hasOwnProperty,De=Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ee={key:!0,ref:!0,__self:!0,__source:!0};function ge(e,o,r){var s,n={},a=null,c=null;r!==void 0&&(a=""+r),o.key!==void 0&&(a=""+o.key),o.ref!==void 0&&(c=o.ref);for(s in o)Fe.call(o,s)&&!Ee.hasOwnProperty(s)&&(n[s]=o[s]);if(e&&e.defaultProps)for(s in o=e.defaultProps,o)n[s]===void 0&&(n[s]=o[s]);return{$$typeof:Re,type:e,key:a,ref:c,props:n,_owner:De.current}}Q.Fragment=Be;Q.jsx=ge;Q.jsxs=ge;xe.exports=Q;var t=xe.exports,se={},fe=ne;se.createRoot=fe.createRoot,se.hydrateRoot=fe.hydrateRoot;const Oe="_container_1kx9n_2",Ae="_uploadZone_1kx9n_10",he={container:Oe,uploadZone:Ae},Pe=({onFilesDrop:e,children:o})=>{const r=c=>{c.preventDefault(),c.currentTarget.style.borderColor="#0969da"},s=c=>{c.currentTarget.style.borderColor="#30363d"},n=c=>{c.preventDefault(),c.currentTarget.style.borderColor="#30363d",e(c.dataTransfer.files)},a=c=>{e(c.target.files),c.target.value=""};return t.jsxs("div",{className:he.container,children:[t.jsxs("div",{className:he.uploadZone,onDragOver:r,onDragLeave:s,onDrop:n,onClick:()=>document.getElementById("fileInput").click(),children:[t.jsx("p",{children:"Drag and drop your source code files here or click to select"}),t.jsx("input",{type:"file",id:"fileInput",style:{display:"none"},multiple:!0,onChange:a})]}),o]})},Me="_button_nc3y6_2",Te="_small_nc3y6_15",He="_medium_nc3y6_22",qe="_large_nc3y6_29",Ue="_primary_nc3y6_47",We="_success_nc3y6_56",ze="_danger_nc3y6_65",Ge="_ghost_nc3y6_75",ee={button:Me,small:Te,medium:He,large:qe,default:"_default_nc3y6_37",primary:Ue,success:We,danger:ze,ghost:Ge},W=({variant:e="default",size:o="medium",disabled:r=!1,type:s="button",onClick:n,children:a,className:c,...m})=>{const _=[ee.button,ee[e],ee[o],c].filter(Boolean).join(" ");return t.jsx("button",{type:s,className:_,onClick:n,disabled:r,...m,children:a})},Je="_buttonWrapper_17g1b_1",Ke={buttonWrapper:Je};function re(e,o,{openChat:r=!1,stream:s=!0,transformCompleteResponse:n=a=>a}={}){const[a,c]=u.useState(o),[m,_]=u.useState(o),[C,f]=u.useState(!1),[g,y]=u.useState(null),[i,l]=u.useState(!1);u.useEffect(()=>{if(!window.Poe){console.info("Poe not found in window object");return}return window.Poe.registerHandler(e,d=>{const p=d.responses[0];p.status==="error"?(y(p.statusText),c(o),f(!0),l(!1)):p.status==="incomplete"?(l(!0),_(p.content)):p.status==="complete"&&(l(!1),c(n(p.content)),_(p.content))})},[]);const h=u.useCallback(async d=>{if(d!=null&&d.trim()){l(!0),f(!1),y(null);try{if(console.log(d),!window.Poe){console.info("Poe not found in window object");return}await window.Poe.sendUserMessage(d,{handler:e,stream:s,openChat:r})}catch(p){console.log(p),f(!0),y(p)}}},[e,r,s]);return{sendMessage:h,sendUserMessage:h,response:a,setResponse:c,isError:C,error:g,isLoading:i,streamingResult:m}}const ce=(e,o,r,{isCanvas:s=!1}={})=>{const n=`@${e} ${o}`,a=JSON.stringify({...r,format:s?"json":"code"});return`${n}
~~~
${a}`},Y=e=>{console.log(e);const o=e.replace(/\n\n---\n\n\[Logs\]\([^\)]+\)/g,"");return console.log(o),JSON.parse(o)},ae=e=>u.useMemo(()=>{try{const r=JSON.parse(e);if(r.status)return r.status}catch{}},[e]),je=u.createContext(),H="~~~",ve=(e,o)=>{if(!e)return[];let r=Object.entries(e).map(([s,n])=>{const[a,c]=s.split(H);return{fileName:a,lineInfo:c,comments:n}});return o!=null&&o.content&&(r=[...r,{fileName:"global",lineInfo:"global",comments:[o]}]),r=r.filter(({comments:s})=>s.length),r},Ze=({comments:e,setComments:o,globalComment:r,setGlobalComment:s,children:n})=>{const a=(i,l,h)=>{const d=`${i}${H}${l}`,p={id:Date.now(),content:h,author:"User"};o(w=>({...w,[d]:[...w[d]||[],p]}))},c=i=>{const l={id:Date.now(),content:i,author:"User"};s(l)},m=()=>(r==null?void 0:r.content)||"",_=(i,l,h,d)=>{const p=`${i}${H}${l}`;o(w=>({...w,[p]:w[p].map((j,A)=>A===h?{...j,content:d}:j)}))},C=(i,l,h)=>{const d=`${i}${H}${l}`;o(p=>({...p,[d]:p[d].filter((w,j)=>j!==h)}))},f=(i,l)=>{const h=`${i}-${l}`;return e[h]||[]},g=u.useCallback(()=>ve(e,r),[e,r]),y=u.useCallback(i=>e?Object.entries(e).filter(([h])=>h.startsWith(`${i}${H}`)).map(([h,d])=>({lineInfo:h.split(H)[1],comments:d})):[],[e]);return t.jsx(je.Provider,{value:{addComment:a,deleteComment:C,updateComment:_,getComments:f,getAllComments:g,addGlobalComment:c,getGlobalComment:m,getAllCommentsForFile:y},children:n})},ie=()=>u.useContext(je),we=u.createContext(null);function Ve({children:e,initialFiles:o,initialComments:r,initialDiff:s,config:n}){const[a,c]=u.useState({}),[m,_]=u.useState(r),[C,f]=u.useState(),[g,y]=u.useState(n),i=ve(m,C),{response:l,isLoading:h,sendMessage:d,streamingResult:p,setResponse:w}=re("store",{isInitial:!0,files:o,comments:null,diff:s,description:g.description},{transformCompleteResponse:Y}),j=ae(p),A=!!Object.keys(a).length,$=!!i.length,G=u.useCallback(()=>{if(!A&&!$)return;const b=ce(g.botName,"/update",{files:a,comments:i},{isCanvas:g.isCanvas});d(b,{transformCompleteResponse:Y})},[a,i,A,$]),q=A||$;u.useEffect(()=>{l.isInitial||(_(l.comments||{}),f(""),c({}),y({...g,shouldShowUpload:!1,isInitialPage:!1}))},[l]);const F={config:g,uploadedFiles:a,setUploadedFiles:c,sendSubmitMessage:G,canSubmitMessage:q,files:l.files,isLoading:h,diff:l.diff,description:l.description,statusText:j,setResponse:w};return t.jsx(we.Provider,{value:F,children:t.jsx(Ze,{setComments:_,setGlobalComment:f,globalComment:C,comments:m,children:e})})}function z(){return u.useContext(we)}JSON.parse(document.getElementById("config-json-data").textContent);const _e=({uploadedFiles:e,onSubmit:o,children:r,...s})=>{const{sendSubmitMessage:n,canSubmitMessage:a}=z();return t.jsx("div",{className:Ke.buttonWrapper,children:t.jsx(W,{onClick:n,disabled:!a,variant:"success",...s,children:r})})};const Ye="_diffContainer_vza99_1",Qe="_fileContent_vza99_3",Xe="_addCommentButton_vza99_23",et="_commentRow_vza99_46",tt="_commentCell_vza99_50",L={diffContainer:Ye,fileContent:Qe,"d2h-code-side-emptyplaceholder":"_d2h-code-side-emptyplaceholder_vza99_13","d2h-info":"_d2h-info_vza99_13",addCommentButton:Xe,commentRow:et,commentCell:tt},nt="_container_1jkch_2",ot="_header_1jkch_14",st="_buttonGroup_1jkch_25",rt="_content_1jkch_31",ct="_noHeader_1jkch_36",U={container:nt,header:ot,buttonGroup:st,content:rt,noHeader:ct},X=({header:e,buttons:o,children:r})=>t.jsxs("div",{className:U.container,children:[e&&t.jsxs("div",{className:U.header,children:[e,t.jsx("div",{className:U.buttonGroup,children:o})]}),t.jsx("div",{className:`${U.content} ${e?"":U.noHeader}`,children:r})]}),le=({content:e,onCopySuccess:o,onCopyError:r,defaultLabel:s="Copy",successLabel:n="Copied!",children:a=s,...c})=>{const[m,_]=u.useState(!1),C=async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(e);else{const f=document.createElement("textarea");f.value=e,f.style.top="0",f.style.left="0",f.style.position="fixed",f.style.opacity="0",document.body.appendChild(f),f.focus(),f.select(),document.execCommand("copy"),document.body.removeChild(f)}_(!0),o==null||o(),setTimeout(()=>_(!1),2e3)}catch(f){r==null||r(f)}};return t.jsx(W,{onClick:C,...c,children:m?n:a})},at="_commentSection_1s7t2_1",it="_stickyComment_1s7t2_12",lt="_commentSectionHeader_1s7t2_22",mt="_comment_1s7t2_1",dt="_commentList_1s7t2_37",ut="_commentWrapper_1s7t2_42",pt="_deleteComment_1s7t2_47",ft="_formHeader_1s7t2_65",ht="_commentContent_1s7t2_70",_t="_commentHeader_1s7t2_74",Ct="_commentAuthor_1s7t2_84",yt="_commentBody_1s7t2_90",xt="_commentForm_1s7t2_97",gt="_commentInput_1s7t2_105",jt="_formFooter_1s7t2_116",vt="_submitComment_1s7t2_120",wt="_closeButton_1s7t2_132",I={commentSection:at,stickyComment:it,commentSectionHeader:lt,comment:mt,commentList:dt,commentWrapper:ut,deleteComment:pt,formHeader:ft,commentContent:ht,commentHeader:_t,commentAuthor:Ct,commentBody:yt,commentForm:xt,commentInput:gt,formFooter:jt,submitComment:vt,closeButton:wt},bt=({content:e,author:o,onDelete:r})=>t.jsx("div",{className:I.comment,children:t.jsx("div",{className:I.commentWrapper,children:t.jsxs("div",{className:I.commentContent,children:[t.jsxs("div",{className:I.commentHeader,children:[t.jsx("span",{className:I.commentAuthor,children:o}),t.jsx("button",{className:I.deleteComment,onClick:r,children:"×"})]}),t.jsx("div",{className:I.commentBody,children:e})]})})}),Nt=({onSubmit:e})=>{const[o,r]=u.useState(""),s=n=>{n.preventDefault(),o.trim()&&(e(o),r(""))};return t.jsxs("form",{className:I.commentForm,onSubmit:s,children:[t.jsx("textarea",{value:o,onChange:n=>r(n.target.value),placeholder:"Add a comment...",className:I.commentInput}),t.jsx("div",{className:I.formFooter,children:t.jsx("button",{onClick:s,className:I.submitComment,children:"Comment"})})]})},be=({lineNumber:e,comments:o,onAddComment:r,onDeleteComment:s,onClose:n})=>t.jsx(Nt,{onSubmit:r}),Ne=({comments:e,onDeleteComment:o})=>e.length?t.jsx("div",{className:I.commentList,children:e.map((r,s)=>t.jsx(bt,{...r,onDelete:()=>o(s)},s))}):null,Se=({content:e,filename:o,children:r="Deploy",...s})=>{const{uploadedFiles:n,config:a}=z(),{sendMessage:c,isLoading:m,response:_,streamingResult:C}=re(`deploy-${o}`,"",{transformCompleteResponse:Y}),f=ae(C);return a.deploySupportedFileExtensions.includes(o.split(".").pop())?_.url?t.jsx(le,{content:_.url,...s,children:"Deployed. Click to Copy!"}):t.jsx(W,{onClick:()=>c(ce(a.botName,"/deploy",{filename:o,files:n},{isCanvas:a.isCanvas})),...s,children:m?f||"Deploying":"Deploy"}):null},St={drawFileList:!1,matching:"lines",outputFormat:"line-by-line",highlight:!1,colorScheme:"dark",renderNothingWhenEmpty:!0,rawTemplates:{"generic-wrapper":'<div class="d2h-auto-color-scheme">{{{content}}}</div>',"line-by-line-file-diff":`
            <div id="{{fileHtmlId}}" data-lang="{{file.language}}">
                <div class="d2h-file-list-wrapper">
                    <div class="d2h-file-list-header">
                        <span class="d2h-file-name-wrapper">
                            <span class="d2h-file-name">{{file.fileName}}</span>
                        </span>
                    </div>
                </div>
                <div class="d2h-file-diff">
                    <div class="d2h-code-wrapper">
                        <table class="d2h-diff-table">
                            <tbody class="d2h-diff-tbody">
                                {{{diffs}}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>`}},$t=M.memo(({file:e,fileContent:o,commentsEnabled:r=!0})=>{const s=M.useRef(null),[n,a]=u.useState(null),c=M.useRef(null),[m,_]=u.useState([]),{addComment:C,deleteComment:f,getComments:g,getAllCommentsForFile:y}=ie(),i=u.useMemo(()=>({__html:Ie([e],St)}),[e]),l=u.useCallback(()=>{if(!s.current)return;(()=>{s.current.querySelectorAll(`.${L.commentRow}`).forEach(v=>{v!==c.current&&v.remove()})})();const q=y(e.newName).reduce((x,{lineInfo:v,comments:D})=>(x[v]=D,x),{}),F=[],b={};s.current.querySelectorAll(".d2h-code-linenumber").forEach(x=>{var E,k,N,O,S,P;const v=(N=(k=(E=x.querySelector(".line-num1"))==null?void 0:E.textContent)==null?void 0:k.trim)==null?void 0:N.call(k),T=((P=(S=(O=x.querySelector(".line-num2"))==null?void 0:O.textContent)==null?void 0:S.trim)==null?void 0:P.call(S))||v;b[T]||(b[T]=[]),b[T].push(x)}),Object.entries(b).forEach(([x,v])=>{const D=q[x];if(!(D!=null&&D.length))return;const E=(v[1]?v[1]:v[0]).closest("tr");if(!E)return;const k=E.closest("tbody");if(!k)return;const N=document.createElement("tr");N.className=`${L.commentRow}`,N.setAttribute("data-line",x);const O=document.createElement("div");O.className="portal-container";const S=document.createElement("td");S.className=`${L.commentCell}`,S.colSpan=3,S.appendChild(O),N.appendChild(S),E.nextSibling?k.insertBefore(N,E.nextSibling):k.appendChild(N),F.push(t.jsx(M.Fragment,{children:ne.createPortal(t.jsx(Ne,{comments:D,onDeleteComment:P=>f(e.newName,x,P)}),O)},`${e.newName}-${x}`))}),_(F)},[e.newName,y,f]);M.useEffect(()=>{setTimeout(async()=>{var $;if(s.current){const G=s.current.querySelectorAll(".d2h-code-linenumber"),q=(($=e.newName)==null?void 0:$.split(".").pop())||"";G.forEach(b=>{const x=b.closest("tr");if(!x.classList.contains("d2h-del")&&r){const v=document.createElement("button");v.className=L.addCommentButton,v.innerHTML="+",x.appendChild(v),x.addEventListener("mouseenter",()=>{v.style.opacity="1"}),x.addEventListener("mouseleave",()=>{v.style.opacity="0"}),v.addEventListener("click",D=>{var P,J,me,de,K,ue;const T=(me=(J=(P=b.querySelector(".line-num1"))==null?void 0:P.textContent)==null?void 0:J.trim)==null?void 0:me.call(J),k=((ue=(K=(de=b.querySelector(".line-num2"))==null?void 0:de.textContent)==null?void 0:K.trim)==null?void 0:ue.call(K))||T;if(n===k)return;c.current&&(c.current.remove(),c.current=null),a(k);const N=document.createElement("tr");N.className=L.commentRow,N.innerHTML=`<td colspan="3" class="${L.commentCell}"></td>`;const O=`.${L.commentRow}[data-line="${k}"]`,S=Array.from(s.current.querySelectorAll(O));if(S.length>0){const pe=S[S.length-1];pe.parentNode.insertBefore(N,pe.nextSibling)}else x.parentNode.insertBefore(N,x.nextSibling);c.current=N})}});const F=s.current.querySelectorAll(".d2h-code-line-ctn");F==null||F.forEach(b=>{b.dataset.highlighted||(oe.configure({ignoreUnescapedHTML:!0}),b.classList.add(`language-${q}`),oe.highlightElement(b))})}},0)},[i,e.newName,r,n]),M.useEffect(()=>{l()},[l]);const h=$=>{n&&(C(e.newName,n,$),l())},d=$=>{f(e.newName,n,$),l()},p=()=>{c.current&&(c.current.remove(),c.current=null),a(null)},w=e.isNew?e.newName:e.oldName,j=e.isRename?`${e.oldName} -> ${e.newName}`:w,A=t.jsxs(t.Fragment,{children:[t.jsx(Se,{size:"small",filename:e.newName}),t.jsx(le,{size:"small",content:o})]});return t.jsx(X,{header:j,buttons:A,children:t.jsxs("div",{className:L.diffContainer,children:[t.jsx("div",{className:L.fileContent,ref:s,dangerouslySetInnerHTML:i}),m,r&&n&&c.current&&ne.createPortal(t.jsx(be,{lineNumber:n,comments:g(e.newName,n),onAddComment:h,onDeleteComment:d,onClose:p}),c.current.querySelector(`.${L.commentCell}`))]})})}),kt=({diff:e,files:o,commentsEnabled:r=!0})=>e?u.useMemo(()=>ye(e),[e]).map(n=>t.jsx($t,{file:n,fileContent:o[n.newName],commentsEnabled:r},n.newName)):null;const It="_container_1mk1f_1",Lt="_codeWrapper_1mk1f_7",Rt="_inlineCommentSection_1mk1f_16",Bt="_codeLine_1mk1f_21",Ft="_lineNumber_1mk1f_35",Dt="_hoverable_1mk1f_48",Et="_lineContent_1mk1f_57",Ot="_addCommentButton_1mk1f_61",B={container:It,codeWrapper:Lt,inlineCommentSection:Rt,codeLine:Bt,lineNumber:Ft,hoverable:Dt,lineContent:Et,addCommentButton:Ot},At=e=>{const o=e.split(".").pop().toLowerCase();return{js:"javascript",jsx:"javascript",ts:"typescript",tsx:"typescript",py:"python",rb:"ruby",java:"java",cpp:"cpp",c:"c",cs:"csharp",html:"html",css:"css",scss:"scss",sass:"scss",php:"php",go:"go",rs:"rust",swift:"swift",kt:"kotlin",md:"markdown",json:"json",xml:"xml",yaml:"yaml",yml:"yaml",sql:"sql",sh:"bash",bash:"bash",dockerfile:"dockerfile"}[o]||"plaintext"},Pt=({lineNumber:e,content:o,commentsEnabled:r,onLineSelect:s,language:n,selectedLine:a,existingComments:c,onAddComment:m,onDeleteComment:_,onClose:C})=>{const[f,g]=u.useState(!1),y=u.useRef(null);return u.useEffect(()=>{!y.current||y.current.dataset.highlighted==="yes"||oe.highlightElement(y.current)},[o]),t.jsxs("div",{className:B.lineContainer,children:[t.jsxs("div",{className:B.codeLine,"data-line":e,onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),onClick:()=>s(e),children:[t.jsx("span",{className:`${B.lineNumber}${r?" "+B.hoverable:""}`,children:String(e).padStart(3)}),t.jsx("span",{ref:y,className:`${B.lineContent} language-${n}`,children:o}),r&&t.jsx("button",{className:B.addCommentButton,style:{opacity:f?1:0},onClick:i=>{i.stopPropagation(),s(e)},children:"+"})]}),c&&c.length>0&&t.jsx("div",{className:B.existingComments,children:t.jsx(Ne,{comments:c,onDeleteComment:i=>_(i)})}),a===e&&r&&t.jsx(be,{lineNumber:e,comments:c||[],onAddComment:m,onDeleteComment:_,onClose:C})]})},Ce=({filename:e,content:o,commentsEnabled:r=!0})=>{const[s,n]=u.useState(null),{addComment:a,deleteComment:c,getAllCommentsForFile:m}=ie(),_=At(e),C=o.split(`
`),f=t.jsxs(t.Fragment,{children:[t.jsx(Se,{size:"small",filename:e}),t.jsx(le,{size:"small",content:o})]}),y=m(e).reduce((h,{lineInfo:d,comments:p})=>(h[d]=p,h),{}),i=(h,d)=>{a(e,h,d)},l=(h,d)=>{c(e,h,d)};return t.jsx(X,{header:e,buttons:f,children:t.jsx("div",{className:B.container,children:t.jsx("pre",{className:B.codeWrapper,children:t.jsx("code",{className:`language-${_}`,children:C.map((h,d)=>{const p=d+1,w=y[p]||[];return t.jsx(Pt,{lineNumber:p,content:h,commentsEnabled:r,onLineSelect:n,language:_,selectedLine:s,existingComments:w,onAddComment:j=>i(p,j),onDeleteComment:j=>l(p,j),onClose:()=>n(null)},p)})})})})})},Mt="_container_7qw4f_2",Tt={container:Mt},Ht="_diffDescription_guii0_2",qt={diffDescription:Ht},$e=({markdown:e=""})=>t.jsx("div",{className:"markdown-container prose prose-sm sm:prose lg:prose-lg max-w-none",dangerouslySetInnerHTML:{__html:ke(e)}}),Ut=({description:e})=>e?t.jsx(X,{children:t.jsx("div",{className:qt.diffDescription,children:t.jsx($e,{markdown:e})})}):null;function Wt(e){return e?ye(e).map(o=>o.newName):[]}const zt="_container_r5p9y_1",Gt="_commentForm_r5p9y_7",Jt="_commentInput_r5p9y_11",te={container:zt,commentForm:Gt,commentInput:Jt},Kt=({children:e})=>{const{addGlobalComment:o,getGlobalComment:r}=ie(),s=r(),n=a=>{const c=a.target.value;o(c)};return t.jsx(X,{header:"Comment",children:t.jsxs("div",{className:te.container,children:[t.jsx("div",{className:te.commentForm,children:t.jsx("textarea",{value:s,onChange:n,placeholder:"What would you like to do?",className:te.commentInput})}),e]})})},Zt="_overlay_yjpva_1",Vt="_content_yjpva_15",Yt="_spinner_yjpva_31",Qt="_spin_yjpva_31",Z={overlay:Zt,content:Vt,spinner:Yt,spin:Qt};function Xt({text:e="Loading...",isVisible:o=!0}){return o?(console.log({text:e}),t.jsx("div",{className:Z.overlay,children:t.jsxs("div",{className:Z.content,children:[t.jsx("div",{className:Z.spinner}),t.jsx("div",{className:Z.text,children:t.jsx($e,{markdown:e})})]})})):null}const en="_container_dn3w7_1",tn="_actions_dn3w7_8",nn="_menuIcon_dn3w7_16",on="_menuIconOpen_dn3w7_22",sn="_menuButton_dn3w7_27",rn="_dropdown_dn3w7_49",cn="_slideIn_dn3w7_1",an="_dropdownContainer_dn3w7_53",ln="_dropdownInner_dn3w7_65",mn="_dropdownItem_dn3w7_69",R={container:en,actions:tn,menuIcon:nn,menuIconOpen:on,menuButton:sn,dropdown:rn,slideIn:cn,dropdownContainer:an,dropdownInner:ln,dropdownItem:mn},dn="_buttonGroup_1l8fr_2",un="_copyButton_1l8fr_8",V={buttonGroup:dn,copyButton:un},pn=({shareUrl:e})=>{if(!e)return null;const o=async(s,n,a,c)=>{if(!(!n||!s))try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(s);else{const m=document.createElement("textarea");m.value=s,m.style.position="fixed",m.style.left="-999999px",m.style.top="-999999px",document.body.appendChild(m),m.focus(),m.select();try{document.execCommand("copy")}finally{m.remove()}}n.textContent=c,setTimeout(()=>{n.textContent=a},2e3)}catch(m){console.error("Failed to copy:",m),n.textContent="Copy failed",setTimeout(()=>{n.textContent=a},2e3)}},r=s=>{s&&(s.preventDefault(),s.stopPropagation());const n=document.querySelector(`.${V.shareButton}`);if(!n){console.error("Share button not found");return}o(e,n,"Share","Link copied!")};return t.jsx("div",{className:V.buttonGroup,children:t.jsx("button",{className:`${V.copyButton} ${V.shareButton}`,onClick:r,children:"Share"})})},fn=({afterApply:e,...o})=>{const{sendMessage:r,isLoading:s,response:n,streamingResult:a}=re("apply_diff_llm","",{transformCompleteResponse:Y}),{setResponse:c,config:m}=z(),_=ae(a);return u.useEffect(()=>{n&&(c(n),e==null||e())},[n]),t.jsx(W,{onClick:()=>r(ce(m.botName,"/apply_diff_llm",{},{isCanvas:m.isCanvas})),...o,children:s?_||"Applying diff":"Looks weird? Apply diff using LLM."})},hn=({shareUrl:e})=>{const[o,r]=u.useState(!1),s=u.useRef(null),{config:n}=z();u.useEffect(()=>{const c=m=>{s.current&&!s.current.contains(m.target)&&r(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[]);const a=()=>{r(!1)};return t.jsx("div",{className:R.container,children:t.jsxs("div",{className:R.actions,children:[t.jsx(pn,{shareUrl:e||`https://poe.com/${n.botName}`}),t.jsxs("div",{className:"relative inline-block",ref:s,children:[t.jsx(W,{variant:"ghost",size:"small",className:R.menuButton,onClick:()=>r(!o),"aria-expanded":o,children:t.jsxs("svg",{className:`${R.menuIcon} ${o?R.menuIconOpen:""}`,width:"16",height:"16",viewBox:"0 0 16 16",children:[t.jsx("circle",{cx:"8",cy:"4",r:"1.5"}),t.jsx("circle",{cx:"8",cy:"8",r:"1.5"}),t.jsx("circle",{cx:"8",cy:"12",r:"1.5"})]})}),o&&t.jsx("div",{className:`${R.dropdownContainer} ${R.dropdown}`,children:t.jsx("div",{className:R.dropdownInner,children:t.jsx(fn,{className:R.dropdownItem,afterApply:a})})})]})]})})},_n=()=>{const{uploadedFiles:e,setUploadedFiles:o,files:r,diff:s,config:n,description:a,isLoading:c,statusText:m}=z(),_=Wt(s),C=Object.keys(r).reduce((i,l)=>(_.includes(l)||(i[l]=r[l]),i),{}),f=async i=>{try{const l=d=>new Promise((p,w)=>{const j=new FileReader;j.onload=()=>p(j.result),j.onerror=w,j.readAsText(d)}),h=await Promise.all(Array.from(i).map(async d=>[d.name,await l(d)]));o(d=>({...d,...Object.fromEntries(h)}))}catch(l){console.error("Error reading files:",l)}},g=i=>{o(l=>{const h={...l};return delete h[i],h})},y=`# 🚀 ${n.botName}
🤯 Tired of AI bots playing hide-and-seek with your code?
Finally! A way to get AI code assistant without the endless "..." or "code continues here" nonsense. Just upload, ask, and get the job done. Simple as that! ⚡️
`;return t.jsxs("div",{className:Tt.container,children:[n.isInitialPage||t.jsx(hn,{shareUrl:n.shareUrl}),t.jsx(Xt,{isVisible:c,text:m}),t.jsx(Ut,{description:n.isInitialPage?y:a}),n.shouldShowUpload&&t.jsx(Pe,{onFilesDrop:f,children:t.jsx(_e,{uploadedFiles:e,size:"large",children:"Send message"})}),t.jsx(kt,{diff:s,files:r,commentsEnabled:n.shouldShowComments}),Object.keys(C).map(i=>t.jsx(Ce,{filename:i,content:C[i],commentsEnabled:n.shouldShowComments},i)),Object.keys(e).map(i=>t.jsx(Ce,{filename:i,content:e[i],onRemove:()=>g(i),commentsEnabled:n.shouldShowComments},i)),n.shouldShowComments&&t.jsx(Kt,{children:t.jsx(_e,{uploadedFiles:e,size:"large",children:"Send message"})})]})},Cn=JSON.parse(document.getElementById("config-json-data").textContent),yn=JSON.parse(document.getElementById("files-json-data").textContent),xn=JSON.parse(document.getElementById("diff-json-data").textContent),gn=JSON.parse(document.getElementById("comments-json-data").textContent);se.createRoot(document.getElementById("root")).render(t.jsx(M.StrictMode,{children:t.jsx(Ve,{initialFiles:yn,initialComments:gn,initialDiff:xn,config:Cn,children:t.jsx(_n,{})})}));
