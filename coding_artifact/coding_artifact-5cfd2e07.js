import{r as m,a as se,R as B,m as Me}from"./assets/vendor-891a2f54.js";import{h as Pe,p as ye}from"./assets/diff2html-520d79da.js";import{H as v,j as Ce,x as xe,c as ve,p as je,g as we,t as be,a as Ne,b as Se,s as ke}from"./assets/hljs-0651ac0c.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&c(a)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}})();var $e={exports:{}},X={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Te=m,He=Symbol.for("react.element"),We=Symbol.for("react.fragment"),Ue=Object.prototype.hasOwnProperty,qe=Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ze={key:!0,ref:!0,__self:!0,__source:!0};function Le(e,n,o){var c,s={},r=null,a=null;o!==void 0&&(r=""+o),n.key!==void 0&&(r=""+n.key),n.ref!==void 0&&(a=n.ref);for(c in n)Ue.call(n,c)&&!ze.hasOwnProperty(c)&&(s[c]=n[c]);if(e&&e.defaultProps)for(c in n=e.defaultProps,n)s[c]===void 0&&(s[c]=n[c]);return{$$typeof:He,type:e,key:r,ref:a,props:s,_owner:qe.current}}X.Fragment=We;X.jsx=Le;X.jsxs=Le;$e.exports=X;var t=$e.exports,oe={},pe=se;oe.createRoot=pe.createRoot,oe.hydrateRoot=pe.hydrateRoot;const Ge="_container_1kx9n_2",Je="_uploadZone_1kx9n_10",fe={container:Ge,uploadZone:Je},Ke=({onFilesDrop:e,children:n})=>{const o=a=>{a.preventDefault(),a.currentTarget.style.borderColor="#0969da"},c=a=>{a.currentTarget.style.borderColor="#30363d"},s=a=>{a.preventDefault(),a.currentTarget.style.borderColor="#30363d",e(a.dataTransfer.files)},r=a=>{e(a.target.files),a.target.value=""};return t.jsxs("div",{className:fe.container,children:[t.jsxs("div",{className:fe.uploadZone,onDragOver:o,onDragLeave:c,onDrop:s,onClick:()=>document.getElementById("fileInput").click(),children:[t.jsx("p",{children:"Drag and drop your source code files here or click to select"}),t.jsx("input",{type:"file",id:"fileInput",style:{display:"none"},multiple:!0,onChange:r})]}),n]})},Ze="_button_nc3y6_2",Ve="_small_nc3y6_15",Ye="_medium_nc3y6_22",Qe="_large_nc3y6_29",Xe="_primary_nc3y6_47",et="_success_nc3y6_56",tt="_danger_nc3y6_65",nt="_ghost_nc3y6_75",te={button:Ze,small:Ve,medium:Ye,large:Qe,default:"_default_nc3y6_37",primary:Xe,success:et,danger:tt,ghost:nt},T=B.forwardRef(({variant:e="default",size:n="medium",disabled:o=!1,type:c="button",onClick:s,children:r,className:a,...p},i)=>{const g=[te.button,te[e],te[n],a].filter(Boolean).join(" ");return t.jsx("button",{ref:i,type:c,className:g,onClick:s,disabled:o,...p,children:r})}),st="_buttonWrapper_17g1b_1",ot={buttonWrapper:st};function re(e,n,{openChat:o=!1,stream:c=!0,transformCompleteResponse:s=r=>r}={}){const[r,a]=m.useState(n),[p,i]=m.useState(n),[g,f]=m.useState(!1),[j,y]=m.useState(null),[_,l]=m.useState(!1);m.useEffect(()=>{if(!window.Poe){console.info("Poe not found in window object");return}return window.Poe.registerHandler(e,h=>{const d=h.responses[0];d.status==="error"?(y(d.statusText),a(n),f(!0),l(!1)):d.status==="incomplete"?(l(!0),i(d.content)):d.status==="complete"&&(l(!1),a(s(d.content)),i(d.content))})},[]);const u=m.useCallback(async h=>{if(h!=null&&h.trim()){l(!0),f(!1),y(null);try{if(console.log(h),!window.Poe){console.info("Poe not found in window object");return}await window.Poe.sendUserMessage(h,{handler:e,stream:c,openChat:o})}catch(d){console.log(d),f(!0),y(d)}}},[e,o,c]);return{sendMessage:u,sendUserMessage:u,response:r,setResponse:a,isError:g,error:j,isLoading:_,streamingResult:p}}const K=(e,n,o,{isCanvas:c=!1}={})=>{const s=`@${e} ${n}`,r=JSON.stringify({...o,format:c?"json":"code"});return`${s}
~~~
${r}`},J=e=>{console.log(e);const n=e.replace(/\n\n---\n\n\[Logs\]\([^\)]+\)/g,"");return console.log(n),JSON.parse(n)},ce=e=>m.useMemo(()=>{try{const o=JSON.parse(e);if(o.status)return o.status}catch{}},[e]),Re=m.createContext(),W="~~~",Ie=(e,n)=>{if(!e)return[];let o=Object.entries(e).map(([c,s])=>{const[r,a]=c.split(W);return{fileName:r,lineInfo:a,comments:s}});return n!=null&&n.content&&(o=[...o,{fileName:"global",lineInfo:"global",comments:[n]}]),o=o.filter(({comments:c})=>c.length),o},rt=e=>typeof e=="object"&&e!==null&&!Array.isArray(e),he=e=>{if(rt(e))return e;const n={};return e.forEach(o=>{if(o.fileName==="global"&&o.lineInfo==="global")return;const c=o.comments.map(r=>({id:r.id,author:r.author,content:r.content||r.Bot})),s=`${o.fileName}${W}${o.lineInfo}`;n[s]=c}),n},ct=({comments:e,setComments:n,globalComment:o,setGlobalComment:c,children:s})=>{const r=(_,l,u)=>{const h=`${_}${W}${l}`,d={id:Date.now(),content:u,author:"User"};n(w=>({...w,[h]:[...w[h]||[],d]}))},a=_=>{const l={id:Date.now(),content:_,author:"User"};c(l)},p=()=>(o==null?void 0:o.content)||"",i=(_,l,u,h)=>{const d=`${_}${W}${l}`;n(w=>({...w,[d]:w[d].map((b,$)=>$===u?{...b,content:h}:b)}))},g=(_,l,u)=>{const h=`${_}${W}${l}`;n(d=>({...d,[h]:d[h].filter((w,b)=>b!==u)}))},f=(_,l)=>{const u=`${_}-${l}`;return e[u]||[]},j=m.useCallback(()=>Ie(e,o),[e,o]),y=m.useCallback(_=>e?Object.entries(e).filter(([u])=>u.startsWith(`${_}${W}`)).map(([u,h])=>({lineInfo:u.split(W)[1],comments:h})):[],[e]);return t.jsx(Re.Provider,{value:{addComment:r,deleteComment:g,updateComment:i,getComments:f,getAllComments:j,addGlobalComment:a,getGlobalComment:p,getAllCommentsForFile:y},children:s})},ae=()=>m.useContext(Re),Fe=m.createContext(null);function at({children:e,initialFiles:n,initialComments:o,initialDiff:c,config:s}){const[r,a]=m.useState({}),[p,i]=m.useState(he(o)),[g,f]=m.useState(),[j,y]=m.useState(s),_=m.useMemo(()=>Ie(p,g),[p,g]),{response:l,isLoading:u,sendMessage:h,streamingResult:d,setResponse:w}=re("store",{isInitialData:!0,files:n,comments:null,diff:c,description:j.description},{transformCompleteResponse:J}),b=ce(d),$=!!Object.keys(r).length,L=m.useMemo(()=>!!_.length,[_]),Z=m.useCallback(()=>{if(!$&&!L)return;const x=K(j.botName,"/update",{files:r,comments:_},{isCanvas:j.isCanvas});h(x,{transformCompleteResponse:J})},[r,_,$,L,g,p]),z=m.useCallback(x=>{h(x,{transformCompleteResponse:J})},[]),E=$||L;m.useEffect(()=>{l.isInitialData||(Array.isArray(l.comments)?i(he(l.comments)):i(l.comments||{}),f(""),a({}),y({...j,shouldShowUpload:!1,isInitialPage:!1}))},[l]);const N=m.useMemo(()=>Object.keys(r).length||Object.keys(l.files).length,[r,l.files]),C={config:j,uploadedFiles:r,hasAnyFiles:N,setUploadedFiles:a,sendSubmitMessage:Z,sendUserMessage:z,canSubmitMessage:E,files:l.files,isLoading:u,diff:l.diff,description:l.description,statusText:b,setResponse:w,isInitialData:l.isInitialData};return t.jsx(Fe.Provider,{value:C,children:t.jsx(ct,{setComments:i,setGlobalComment:f,globalComment:g,comments:p,children:e})})}function U(){return m.useContext(Fe)}JSON.parse(document.getElementById("config-json-data").textContent);const ge=({uploadedFiles:e,onSubmit:n,children:o,...c})=>{const{sendSubmitMessage:s,canSubmitMessage:r}=U();return t.jsx("div",{className:ot.buttonWrapper,children:t.jsx(T,{onClick:s,disabled:!r,variant:"success",...c,children:o})})};const it="_diffContainer_vza99_1",lt="_fileContent_vza99_3",mt="_addCommentButton_vza99_23",dt="_commentRow_vza99_46",ut="_commentCell_vza99_50",F={diffContainer:it,fileContent:lt,"d2h-code-side-emptyplaceholder":"_d2h-code-side-emptyplaceholder_vza99_13","d2h-info":"_d2h-info_vza99_13",addCommentButton:mt,commentRow:dt,commentCell:ut},pt="_container_1jkch_2",ft="_header_1jkch_14",ht="_buttonGroup_1jkch_25",gt="_content_1jkch_31",_t="_noHeader_1jkch_36",G={container:pt,header:ft,buttonGroup:ht,content:gt,noHeader:_t},ee=({header:e,buttons:n,children:o})=>t.jsxs("div",{className:G.container,children:[e&&t.jsxs("div",{className:G.header,children:[e,t.jsx("div",{className:G.buttonGroup,children:n})]}),t.jsx("div",{className:`${G.content} ${e?"":G.noHeader}`,children:o})]}),ie=({content:e,onCopySuccess:n,onCopyError:o,defaultLabel:c="Copy",successLabel:s="Copied!",children:r=c,...a})=>{const[p,i]=m.useState(!1),g=async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(e);else{const f=document.createElement("textarea");f.value=e,f.style.top="0",f.style.left="0",f.style.position="fixed",f.style.opacity="0",document.body.appendChild(f),f.focus(),f.select(),document.execCommand("copy"),document.body.removeChild(f)}i(!0),n==null||n(),setTimeout(()=>i(!1),2e3)}catch(f){o==null||o(f)}};return t.jsx(T,{onClick:g,...a,children:p?s:r})},yt="_commentSection_1cdyk_1",Ct="_stickyComment_1cdyk_13",xt="_commentSectionHeader_1cdyk_23",vt="_comment_1cdyk_1",jt="_commentList_1cdyk_42",wt="_commentWrapper_1cdyk_50",bt="_deleteComment_1cdyk_55",Nt="_formHeader_1cdyk_73",St="_commentContent_1cdyk_78",kt="_commentHeader_1cdyk_84",$t="_commentAuthor_1cdyk_94",Lt="_commentBody_1cdyk_100",Rt="_commentForm_1cdyk_109",It="_commentInput_1cdyk_118",Ft="_formFooter_1cdyk_129",Dt="_submitComment_1cdyk_133",Bt="_closeButton_1cdyk_145",I={commentSection:yt,stickyComment:Ct,commentSectionHeader:xt,comment:vt,commentList:jt,commentWrapper:wt,deleteComment:bt,formHeader:Nt,commentContent:St,commentHeader:kt,commentAuthor:$t,commentBody:Lt,commentForm:Rt,commentInput:It,formFooter:Ft,submitComment:Dt,closeButton:Bt},Ot=({content:e,author:n,onDelete:o})=>t.jsx("div",{className:I.comment,children:t.jsx("div",{className:I.commentWrapper,children:t.jsxs("div",{className:I.commentContent,children:[t.jsxs("div",{className:I.commentHeader,children:[t.jsx("span",{className:I.commentAuthor,children:n}),t.jsx("button",{className:I.deleteComment,onClick:o,children:"×"})]}),t.jsx("div",{className:I.commentBody,children:e})]})})}),De=e=>{const[n,o]=m.useState(0),c=m.useRef(null);return m.useEffect(()=>{const s=i=>i?i.matches(e)?i:i.closest(e):null,r=()=>{const i=s(c.current);if(i){const g=i.scrollWidth;o(g)}},a=new ResizeObserver(r),p=s(c.current);return p&&a.observe(p),()=>{a.disconnect()}},[e]),[n,c]},Be=({onAddComment:e})=>{const[n,o]=m.useState(""),[c,s]=De(".d2h-auto-color-scheme, .code-viewer-wrapper"),r=a=>{a.preventDefault(),n.trim()&&(e(n),o(""))};return t.jsxs("form",{className:I.commentForm,onSubmit:r,ref:s,style:{width:c?`${c}px`:"100%"},children:[t.jsx("textarea",{value:n,onChange:a=>o(a.target.value),placeholder:"Add a comment...",className:I.commentInput}),t.jsx("div",{className:I.formFooter,children:t.jsx("button",{onClick:r,className:I.submitComment,children:"Comment"})})]})},Oe=({comments:e,onDeleteComment:n})=>{const[o,c]=De(".d2h-auto-color-scheme, .code-viewer-wrapper");return e.length?t.jsx("div",{className:I.commentList,ref:c,style:{width:o?`${o}px`:"100%"},children:e.map((s,r)=>t.jsx(Ot,{...s,onDelete:()=>n(r)},r))}):null},Ee=({content:e,filename:n,children:o="Deploy",...c})=>{const{uploadedFiles:s,config:r,files:a}=U(),{sendMessage:p,isLoading:i,response:g,streamingResult:f,setResponse:j}=re(`deploy-${n}`,"",{transformCompleteResponse:J}),y=ce(f);return B.useEffect(()=>{j("")},[a]),r.deploySupportedFileExtensions.includes(n.split(".").pop())?g.url?t.jsx(ie,{content:g.url,...c,children:"Deployed. Click to Copy!"}):t.jsx(T,{onClick:()=>p(K(r.botName,"/deploy",{filename:n,files:s},{isCanvas:r.isCanvas})),...c,children:i?y||"Deploying":"Deploy"}):null};v.registerLanguage("javascript",Ce);v.registerLanguage("html",xe);v.registerLanguage("css",ve);v.registerLanguage("python",je);v.registerLanguage("go",we);v.registerLanguage("typescript",be);v.registerLanguage("json",Ne);v.registerLanguage("bash",Se);v.registerLanguage("sql",ke);const Et={drawFileList:!1,matching:"lines",outputFormat:"line-by-line",highlight:!1,colorScheme:"dark",renderNothingWhenEmpty:!0,rawTemplates:{"generic-wrapper":'<div class="d2h-auto-color-scheme">{{{content}}}</div>',"line-by-line-file-diff":`
            <div id="{{fileHtmlId}}" data-lang="{{file.language}}">
                <div class="d2h-file-list-wrapper">
                    <div class="d2h-file-list-header">
                        <span class="d2h-file-name-wrapper">
                            <span class="d2h-file-name">{{file.fileName}}</span>
                        </span>
                    </div>
                </div>
                <div class="d2h-file-diff">
                    <div class="d2h-code-wrapper">
                        <table class="d2h-diff-table">
                            <tbody class="d2h-diff-tbody">
                                {{{diffs}}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>`}},At=B.memo(({file:e,fileContent:n,commentsEnabled:o=!0})=>{const c=B.useRef(null),[s,r]=m.useState(null),a=B.useRef(null),[p,i]=m.useState([]),{addComment:g,deleteComment:f,getComments:j,getAllCommentsForFile:y}=ae(),_=m.useMemo(()=>({__html:Pe([e],Et)}),[e]),l=m.useCallback(()=>{if(!c.current)return;(()=>{c.current.querySelectorAll(`.${F.commentRow}`).forEach(x=>{x!==a.current&&x.remove()})})();const z=y(e.newName).reduce((C,{lineInfo:x,comments:A})=>(C[x]=A,C),{}),E=[],N={};c.current.querySelectorAll(".d2h-code-linenumber").forEach(C=>{var M,R,S,P,k,H;const x=(S=(R=(M=C.querySelector(".line-num1"))==null?void 0:M.textContent)==null?void 0:R.trim)==null?void 0:S.call(R),q=((H=(k=(P=C.querySelector(".line-num2"))==null?void 0:P.textContent)==null?void 0:k.trim)==null?void 0:H.call(k))||x;N[q]||(N[q]=[]),N[q].push(C)}),Object.entries(N).forEach(([C,x])=>{const A=z[C];if(!(A!=null&&A.length))return;const M=(x[1]?x[1]:x[0]).closest("tr");if(!M)return;const R=M.closest("tbody");if(!R)return;const S=document.createElement("tr");S.className=`${F.commentRow}`,S.setAttribute("data-line",C);const P=document.createElement("div");P.className="portal-container";const k=document.createElement("td");k.className=`${F.commentCell}`,k.colSpan=3,k.appendChild(P),S.appendChild(k),M.nextSibling?R.insertBefore(S,M.nextSibling):R.appendChild(S),E.push(t.jsx(B.Fragment,{children:se.createPortal(t.jsx(Oe,{comments:A,onDeleteComment:H=>f(e.newName,C,H)}),P)},`${e.newName}-${C}`))}),i(E)},[e.newName,y,f]);B.useEffect(()=>{setTimeout(async()=>{var L;if(c.current){const Z=c.current.querySelectorAll(".d2h-code-linenumber"),z=((L=e.newName)==null?void 0:L.split(".").pop())||"";Z.forEach(N=>{const C=N.closest("tr");if(!C.classList.contains("d2h-del")&&o){const x=document.createElement("button");x.className=F.addCommentButton,x.innerHTML="+",C.appendChild(x),C.addEventListener("mouseenter",()=>{x.style.opacity="1"}),C.addEventListener("mouseleave",()=>{x.style.opacity="0"}),x.addEventListener("click",A=>{var H,V,le,me,Y,de;const q=(le=(V=(H=N.querySelector(".line-num1"))==null?void 0:H.textContent)==null?void 0:V.trim)==null?void 0:le.call(V),R=((de=(Y=(me=N.querySelector(".line-num2"))==null?void 0:me.textContent)==null?void 0:Y.trim)==null?void 0:de.call(Y))||q;if(s===R)return;a.current&&(a.current.remove(),a.current=null),r(R);const S=document.createElement("tr");S.className=F.commentRow,S.innerHTML=`<td colspan="3" class="${F.commentCell}"></td>`;const P=`.${F.commentRow}[data-line="${R}"]`,k=Array.from(c.current.querySelectorAll(P));if(k.length>0){const ue=k[k.length-1];ue.parentNode.insertBefore(S,ue.nextSibling)}else C.parentNode.insertBefore(S,C.nextSibling);a.current=S})}});const E=c.current.querySelectorAll(".d2h-code-line-ctn");E==null||E.forEach(N=>{N.dataset.highlighted||(v.configure({ignoreUnescapedHTML:!0}),N.classList.add(`language-${z}`),v.highlightElement(N))})}},0)},[_,e.newName,o,s]),B.useEffect(()=>{l()},[l]);const u=L=>{s&&(g(e.newName,s,L),l())},h=L=>{f(e.newName,s,L),l()},d=()=>{a.current&&(a.current.remove(),a.current=null),r(null)},w=e.isNew?e.newName:e.oldName,b=e.isRename?`${e.oldName} -> ${e.newName}`:w,$=t.jsxs(t.Fragment,{children:[t.jsx(Ee,{size:"small",filename:e.newName}),t.jsx(ie,{size:"small",content:n})]});return t.jsx(ee,{header:b,buttons:$,children:t.jsxs("div",{className:F.diffContainer,children:[t.jsx("div",{className:F.fileContent,ref:c,dangerouslySetInnerHTML:_}),p,o&&s&&a.current&&se.createPortal(t.jsx(Be,{lineNumber:s,comments:j(e.newName,s),onAddComment:u,onDeleteComment:h,onClose:d}),a.current.querySelector(`.${F.commentCell}`))]})})}),Mt=({diff:e,files:n,commentsEnabled:o=!0})=>e?m.useMemo(()=>ye(e),[e]).map(s=>t.jsx(At,{file:s,fileContent:n[s.newName],commentsEnabled:o},s.newName)):null;const Pt="_container_1mk1f_1",Tt="_codeWrapper_1mk1f_7",Ht="_inlineCommentSection_1mk1f_16",Wt="_codeLine_1mk1f_21",Ut="_lineNumber_1mk1f_35",qt="_hoverable_1mk1f_48",zt="_lineContent_1mk1f_57",Gt="_addCommentButton_1mk1f_61",O={container:Pt,codeWrapper:Tt,inlineCommentSection:Ht,codeLine:Wt,lineNumber:Ut,hoverable:qt,lineContent:zt,addCommentButton:Gt};v.registerLanguage("javascript",Ce);v.registerLanguage("html",xe);v.registerLanguage("css",ve);v.registerLanguage("python",je);v.registerLanguage("go",we);v.registerLanguage("typescript",be);v.registerLanguage("json",Ne);v.registerLanguage("bash",Se);v.registerLanguage("sql",ke);const Jt=e=>{const n=e.split(".").pop().toLowerCase();return{js:"javascript",jsx:"javascript",ts:"typescript",tsx:"typescript",py:"python",rb:"ruby",java:"java",cpp:"cpp",c:"c",cs:"csharp",html:"html",css:"css",scss:"scss",sass:"scss",php:"php",go:"go",rs:"rust",swift:"swift",kt:"kotlin",md:"markdown",json:"json",xml:"xml",yaml:"yaml",yml:"yaml",sql:"sql",sh:"bash",bash:"bash",dockerfile:"dockerfile"}[n]||"plaintext"},Kt=({lineNumber:e,content:n,commentsEnabled:o,onLineSelect:c,language:s,selectedLine:r,existingComments:a,onAddComment:p,onDeleteComment:i,onClose:g})=>{const[f,j]=m.useState(!1),y=m.useRef(null);return m.useEffect(()=>{!y.current||y.current.dataset.highlighted==="yes"||v.highlightElement(y.current)},[n]),t.jsxs("div",{className:O.lineContainer,children:[t.jsxs("div",{className:O.codeLine,"data-line":e,onMouseEnter:()=>j(!0),onMouseLeave:()=>j(!1),onClick:()=>c(e),children:[t.jsx("span",{className:`${O.lineNumber}${o?" "+O.hoverable:""}`,children:String(e).padStart(3)}),t.jsx("span",{ref:y,className:`${O.lineContent} language-${s}`,children:n}),o&&t.jsx("button",{className:O.addCommentButton,style:{opacity:f?1:0},onClick:_=>{_.stopPropagation(),c(e)},children:"+"})]}),a&&a.length>0&&t.jsx("div",{className:O.existingComments,children:t.jsx(Oe,{comments:a,onDeleteComment:_=>i(_)})}),r===e&&o&&t.jsx(Be,{lineNumber:e,comments:a||[],onAddComment:p,onDeleteComment:i,onClose:g})]})},_e=({filename:e,content:n,commentsEnabled:o=!0})=>{const[c,s]=m.useState(null),{addComment:r,deleteComment:a,getAllCommentsForFile:p}=ae(),i=Jt(e),g=n.split(`
`),f=t.jsxs(t.Fragment,{children:[t.jsx(Ee,{size:"small",filename:e}),t.jsx(ie,{size:"small",content:n})]}),y=p(e).reduce((u,{lineInfo:h,comments:d})=>(u[h]=d,u),{}),_=(u,h)=>{r(e,u,h)},l=(u,h)=>{a(e,u,h)};return t.jsx(ee,{header:e,buttons:f,children:t.jsx("div",{className:O.container,children:t.jsx("pre",{className:`${O.codeWrapper} code-viewer-wrapper`,children:t.jsx("code",{className:`language-${i}`,children:g.map((u,h)=>{const d=h+1,w=y[d]||[];return t.jsx(Kt,{lineNumber:d,content:u,commentsEnabled:o,onLineSelect:s,language:i,selectedLine:c,existingComments:w,onAddComment:b=>_(d,b),onDeleteComment:b=>l(d,b),onClose:()=>s(null)},d)})})})})})},Zt="_container_7qw4f_2",Vt={container:Zt},Yt="_diffDescription_guii0_2",Qt={diffDescription:Yt},Ae=({markdown:e=""})=>t.jsx("div",{className:"markdown-container prose prose-sm sm:prose lg:prose-lg max-w-none",dangerouslySetInnerHTML:{__html:Me(e)}}),Xt=({description:e})=>e?t.jsx(ee,{children:t.jsx("div",{className:Qt.diffDescription,children:t.jsx(Ae,{markdown:e})})}):null;function en(e){return e?ye(e).map(n=>n.newName):[]}const tn="_container_r5p9y_1",nn="_commentForm_r5p9y_7",sn="_commentInput_r5p9y_11",ne={container:tn,commentForm:nn,commentInput:sn},on=({children:e})=>{const{addGlobalComment:n,getGlobalComment:o}=ae(),c=o(),s=r=>{const a=r.target.value;n(a)};return t.jsx(ee,{header:"Comment",children:t.jsxs("div",{className:ne.container,children:[t.jsx("div",{className:ne.commentForm,children:t.jsx("textarea",{value:c,onChange:s,placeholder:"What would you like to do?",className:ne.commentInput})}),e]})})},rn="_overlay_yjpva_1",cn="_content_yjpva_15",an="_spinner_yjpva_31",ln="_spin_yjpva_31",Q={overlay:rn,content:cn,spinner:an,spin:ln};function mn({text:e="Loading...",isVisible:n=!0}){return n?t.jsx("div",{className:Q.overlay,children:t.jsxs("div",{className:Q.content,children:[t.jsx("div",{className:Q.spinner}),t.jsx("div",{className:Q.text,children:t.jsx(Ae,{markdown:e})})]})}):null}const dn="_container_n3ycs_1",un="_actions_n3ycs_8",pn="_menuIcon_n3ycs_16",fn="_menuIconOpen_n3ycs_22",hn="_menuButton_n3ycs_27",gn="_dropdown_n3ycs_49",_n="_slideIn_n3ycs_1",yn="_dropdownContainer_n3ycs_53",Cn="_dropdownInner_n3ycs_65",xn="_dropdownItem_n3ycs_69",D={container:dn,actions:un,menuIcon:pn,menuIconOpen:fn,menuButton:hn,dropdown:gn,slideIn:_n,dropdownContainer:yn,dropdownInner:Cn,dropdownItem:xn},vn="_buttonGroup_1eusd_2",jn={buttonGroup:vn},wn=({shareUrl:e})=>{const n=B.useRef(null);if(!e)return null;const o=async(s,r,a,p)=>{if(!(!r||!s))try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(s);else{const i=document.createElement("textarea");i.value=s,i.style.position="fixed",i.style.left="-999999px",i.style.top="-999999px",document.body.appendChild(i),i.focus(),i.select();try{document.execCommand("copy")}finally{i.remove()}}r.textContent=p,setTimeout(()=>{r.textContent=a},2e3)}catch(i){console.error("Failed to copy:",i),r.textContent="Copy failed",setTimeout(()=>{r.textContent=a},2e3)}},c=s=>{s&&(s.preventDefault(),s.stopPropagation());const r=n.current;if(!r){console.error("Share button not found");return}o(e,r,"Share","Link copied!")};return t.jsx("div",{className:jn.buttonGroup,children:t.jsx(T,{ref:n,onClick:c,children:"Share"})})},bn=({afterApply:e,...n})=>{const{config:o,diff:c,sendUserMessage:s}=U();return c?t.jsx(T,{onClick:()=>s(K(o.botName,"/apply_diff_llm",{},{isCanvas:o.isCanvas})),...n,children:"Re-apply diff"}):null},Nn=({afterApply:e,...n})=>{const{sendMessage:o,isLoading:c,response:s,streamingResult:r}=re("review","",{transformCompleteResponse:J}),{setResponse:a,config:p,hasAnyFiles:i,uploadedFiles:g}=U(),f=ce(r);return m.useEffect(()=>{s&&(a(s),e==null||e())},[s]),i?t.jsx(T,{onClick:()=>o(K(p.botName,"/review",{files:g},{isCanvas:p.isCanvas})),...n,children:c?f||"Reviewing the code...":"Code review"}):null},Sn=({afterApply:e,...n})=>{const{config:o,diff:c,sendUserMessage:s,hasAnyFiles:r}=U();return c||r?null:t.jsx(T,{onClick:()=>s(K(o.botName,"/continue",{},{isCanvas:o.isCanvas})),...n,children:"Restore"})};function kn(){const e=m.useRef(null),[n,o]=m.useState(!1);return m.useEffect(()=>{if(!e.current)return;const c=()=>{var p,i,g;const r=!!((i=(p=e.current)==null?void 0:p.textContent)!=null&&i.trim()),a=((g=e.current)==null?void 0:g.childNodes.length)>0;o(r||a)};c();const s=new MutationObserver(c);return s.observe(e.current,{childList:!0,characterData:!0,subtree:!0}),()=>s.disconnect()},[e.current]),{ref:e,hasContent:n}}const $n=({shareUrl:e})=>{const[n,o]=m.useState(!1),c=m.useRef(null),{config:s}=U(),{ref:r,hasContent:a}=kn();m.useEffect(()=>{const i=g=>{c.current&&!c.current.contains(g.target)&&o(!1)};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[]);const p=()=>{o(!1)};return t.jsx("div",{className:D.container,children:t.jsxs("div",{className:D.actions,children:[t.jsx(wn,{shareUrl:e||`https://poe.com/${s.botName}`}),t.jsx(Sn,{}),t.jsxs("div",{className:"relative inline-block",ref:c,style:a?{}:{display:"none"},children:[t.jsx(T,{variant:"ghost",size:"small",className:D.menuButton,onClick:()=>o(!n),"aria-expanded":n,children:t.jsxs("svg",{className:`${D.menuIcon} ${n?D.menuIconOpen:""}`,width:"16",height:"16",viewBox:"0 0 16 16",children:[t.jsx("circle",{cx:"8",cy:"4",r:"1.5"}),t.jsx("circle",{cx:"8",cy:"8",r:"1.5"}),t.jsx("circle",{cx:"8",cy:"12",r:"1.5"})]})}),t.jsx("div",{className:`${D.dropdownContainer} ${D.dropdown}`,style:n?{}:{display:"none"},children:t.jsxs("div",{className:D.dropdownInner,ref:r,children:[t.jsx(Nn,{className:D.dropdownItem,afterApply:p}),t.jsx(bn,{className:D.dropdownItem,afterApply:p})]})})]})]})})},Ln=()=>{const{uploadedFiles:e,setUploadedFiles:n,files:o,diff:c,config:s,description:r,isLoading:a,statusText:p,isInitialData:i}=U(),g=en(c),f=Object.keys(o).reduce((l,u)=>(g.includes(u)||(l[u]=o[u]),l),{}),j=async l=>{try{const u=d=>new Promise((w,b)=>{const $=new FileReader;$.onload=()=>w($.result),$.onerror=b,$.readAsText(d)}),h=await Promise.all(Array.from(l).map(async d=>[d.name,await u(d)]));n(d=>({...d,...Object.fromEntries(h)}))}catch(u){console.error("Error reading files:",u)}},y=l=>{n(u=>{const h={...u};return delete h[l],h})},_=`# 🚀 ${s.botName}
🤯 Tired of AI bots playing hide-and-seek with your code?
Finally! A way to get AI code assistant without the endless "..." or "code continues here" nonsense. Just upload, ask, and get the job done. Simple as that! ⚡️
`;return t.jsxs("div",{className:Vt.container,children:[t.jsx($n,{shareUrl:i?s.shareUrl:null}),t.jsx(mn,{isVisible:a,text:p}),t.jsx(Xt,{description:s.isInitialPage?_:r}),s.shouldShowUpload&&t.jsx(Ke,{onFilesDrop:j,children:t.jsx(ge,{uploadedFiles:e,size:"large",children:"Send message"})}),t.jsx(Mt,{diff:c,files:o,commentsEnabled:s.shouldShowComments}),Object.keys(f).map(l=>t.jsx(_e,{filename:l,content:f[l],commentsEnabled:s.shouldShowComments},l)),Object.keys(e).map(l=>t.jsx(_e,{filename:l,content:e[l],onRemove:()=>y(l),commentsEnabled:s.shouldShowComments},l)),s.shouldShowComments&&t.jsx(on,{children:t.jsx(ge,{uploadedFiles:e,size:"large",children:"Send message"})})]})},Rn=JSON.parse(document.getElementById("config-json-data").textContent),In=JSON.parse(document.getElementById("files-json-data").textContent),Fn=JSON.parse(document.getElementById("diff-json-data").textContent),Dn=JSON.parse(document.getElementById("comments-json-data").textContent);oe.createRoot(document.getElementById("root")).render(t.jsx(B.StrictMode,{children:t.jsx(at,{initialFiles:In,initialComments:Dn,initialDiff:Fn,config:Rn,children:t.jsx(Ln,{})})}));
