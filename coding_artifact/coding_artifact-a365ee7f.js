import{r as m,a as re,R as M,m as Re}from"./assets/vendor-891a2f54.js";import{h as Le,p as xe}from"./assets/diff2html-520d79da.js";import{H as ce}from"./assets/hljs-c6694249.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function s(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(n){if(n.ep)return;n.ep=!0;const c=s(n);fetch(n.href,c)}})();var ge={exports:{}},Q={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Be=m,Fe=Symbol.for("react.element"),De=Symbol.for("react.fragment"),Ee=Object.prototype.hasOwnProperty,Oe=Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ae={key:!0,ref:!0,__self:!0,__source:!0};function ve(e,o,s){var r,n={},c=null,a=null;s!==void 0&&(c=""+s),o.key!==void 0&&(c=""+o.key),o.ref!==void 0&&(a=o.ref);for(r in o)Ee.call(o,r)&&!Ae.hasOwnProperty(r)&&(n[r]=o[r]);if(e&&e.defaultProps)for(r in o=e.defaultProps,o)n[r]===void 0&&(n[r]=o[r]);return{$$typeof:Fe,type:e,key:c,ref:a,props:n,_owner:Oe.current}}Q.Fragment=De;Q.jsx=ve;Q.jsxs=ve;ge.exports=Q;var t=ge.exports,ae={},fe=re;ae.createRoot=fe.createRoot,ae.hydrateRoot=fe.hydrateRoot;const Me="_container_1kx9n_2",Pe="_uploadZone_1kx9n_10",he={container:Me,uploadZone:Pe},Te=({onFilesDrop:e,children:o})=>{const s=a=>{a.preventDefault(),a.currentTarget.style.borderColor="#0969da"},r=a=>{a.currentTarget.style.borderColor="#30363d"},n=a=>{a.preventDefault(),a.currentTarget.style.borderColor="#30363d",e(a.dataTransfer.files)},c=a=>{e(a.target.files),a.target.value=""};return t.jsxs("div",{className:he.container,children:[t.jsxs("div",{className:he.uploadZone,onDragOver:s,onDragLeave:r,onDrop:n,onClick:()=>document.getElementById("fileInput").click(),children:[t.jsx("p",{children:"Drag and drop your source code files here or click to select"}),t.jsx("input",{type:"file",id:"fileInput",style:{display:"none"},multiple:!0,onChange:c})]}),o]})},He="_button_nc3y6_2",We="_small_nc3y6_15",qe="_medium_nc3y6_22",ze="_large_nc3y6_29",Ue="_primary_nc3y6_47",Ge="_success_nc3y6_56",Je="_danger_nc3y6_65",Ke="_ghost_nc3y6_75",oe={button:He,small:We,medium:qe,large:ze,default:"_default_nc3y6_37",primary:Ue,success:Ge,danger:Je,ghost:Ke},W=({variant:e="default",size:o="medium",disabled:s=!1,type:r="button",onClick:n,children:c,className:a,...l})=>{const d=[oe.button,oe[e],oe[o],a].filter(Boolean).join(" ");return t.jsx("button",{type:r,className:d,onClick:n,disabled:s,...l,children:c})},Ze="_buttonWrapper_17g1b_1",Ve={buttonWrapper:Ze};function X(e,o,{openChat:s=!1,stream:r=!0,transformCompleteResponse:n=c=>c}={}){const[c,a]=m.useState(o),[l,d]=m.useState(o),[C,f]=m.useState(!1),[x,y]=m.useState(null),[_,i]=m.useState(!1);m.useEffect(()=>{if(!window.Poe){console.info("Poe not found in window object");return}return window.Poe.registerHandler(e,h=>{const u=h.responses[0];u.status==="error"?(y(u.statusText),a(o),f(!0),i(!1)):u.status==="incomplete"?(i(!0),d(u.content)):u.status==="complete"&&(i(!1),a(n(u.content)),d(u.content))})},[]);const p=m.useCallback(async h=>{if(h!=null&&h.trim()){i(!0),f(!1),y(null);try{if(console.log(h),!window.Poe){console.info("Poe not found in window object");return}await window.Poe.sendUserMessage(h,{handler:e,stream:r,openChat:s})}catch(u){console.log(u),f(!0),y(u)}}},[e,s,r]);return{sendMessage:p,sendUserMessage:p,response:c,setResponse:a,isError:C,error:x,isLoading:_,streamingResult:l}}const ee=(e,o,s,{isCanvas:r=!1}={})=>{const n=`@${e} ${o}`,c=JSON.stringify({...s,format:r?"json":"code"});return`${n}
~~~
${c}`},G=e=>{console.log(e);const o=e.replace(/\n\n---\n\n\[Logs\]\([^\)]+\)/g,"");return console.log(o),JSON.parse(o)},te=e=>m.useMemo(()=>{try{const s=JSON.parse(e);if(s.status)return s.status}catch{}},[e]),je=m.createContext(),T="~~~",we=(e,o)=>{if(!e)return[];let s=Object.entries(e).map(([r,n])=>{const[c,a]=r.split(T);return{fileName:c,lineInfo:a,comments:n}});return o!=null&&o.content&&(s=[...s,{fileName:"global",lineInfo:"global",comments:[o]}]),s=s.filter(({comments:r})=>r.length),s},Ye=e=>typeof e=="object"&&e!==null&&!Array.isArray(e),_e=e=>{if(Ye(e))return e;const o={};return console.log(e),e.forEach(s=>{if(s.fileName==="global"&&s.lineInfo==="global")return;const r=s.comments.map(c=>({id:c.id,author:c.author,content:c.content||c.Bot})),n=`${s.fileName}${T}${s.lineInfo}`;o[n]=r}),o},Qe=({comments:e,setComments:o,globalComment:s,setGlobalComment:r,children:n})=>{const c=(_,i,p)=>{const h=`${_}${T}${i}`,u={id:Date.now(),content:p,author:"User"};o(j=>({...j,[h]:[...j[h]||[],u]}))},a=_=>{const i={id:Date.now(),content:_,author:"User"};r(i)},l=()=>(s==null?void 0:s.content)||"",d=(_,i,p,h)=>{const u=`${_}${T}${i}`;o(j=>({...j,[u]:j[u].map((w,k)=>k===p?{...w,content:h}:w)}))},C=(_,i,p)=>{const h=`${_}${T}${i}`;o(u=>({...u,[h]:u[h].filter((j,w)=>w!==p)}))},f=(_,i)=>{const p=`${_}-${i}`;return e[p]||[]},x=m.useCallback(()=>we(e,s),[e,s]),y=m.useCallback(_=>e?Object.entries(e).filter(([p])=>p.startsWith(`${_}${T}`)).map(([p,h])=>({lineInfo:p.split(T)[1],comments:h})):[],[e]);return t.jsx(je.Provider,{value:{addComment:c,deleteComment:C,updateComment:d,getComments:f,getAllComments:x,addGlobalComment:a,getGlobalComment:l,getAllCommentsForFile:y},children:n})},ie=()=>m.useContext(je),be=m.createContext(null);function Xe({children:e,initialFiles:o,initialComments:s,initialDiff:r,config:n}){const[c,a]=m.useState({}),[l,d]=m.useState(_e(s)),[C,f]=m.useState();console.log(l);const[x,y]=m.useState(n),_=m.useMemo(()=>we(l,C),[l,C]),{response:i,isLoading:p,sendMessage:h,streamingResult:u,setResponse:j}=X("store",{isInitialData:!0,files:o,comments:null,diff:r,description:x.description},{transformCompleteResponse:G}),w=te(u),k=!!Object.keys(c).length,$=m.useMemo(()=>!!_.length,[_]),J=m.useCallback(()=>{if(!k&&!$)return;const b=ee(x.botName,"/update",{files:c,comments:_},{isCanvas:x.isCanvas});h(b,{transformCompleteResponse:G})},[c,_,k,$,C,l]),z=k||$;m.useEffect(()=>{i.isInitialData||(Array.isArray(i.comments)?d(_e(i.comments)):d(i.comments||{}),f(""),a({}),y({...x,shouldShowUpload:!1,isInitialPage:!1}))},[i]);const D={config:x,uploadedFiles:c,setUploadedFiles:a,sendSubmitMessage:J,canSubmitMessage:z,files:i.files,isLoading:p,diff:i.diff,description:i.description,statusText:w,setResponse:j,isInitialData:i.isInitialData};return t.jsx(be.Provider,{value:D,children:t.jsx(Qe,{setComments:d,setGlobalComment:f,globalComment:C,comments:l,children:e})})}function q(){return m.useContext(be)}JSON.parse(document.getElementById("config-json-data").textContent);const Ce=({uploadedFiles:e,onSubmit:o,children:s,...r})=>{const{sendSubmitMessage:n,canSubmitMessage:c}=q();return t.jsx("div",{className:Ve.buttonWrapper,children:t.jsx(W,{onClick:n,disabled:!c,variant:"success",...r,children:s})})};const et="_diffContainer_vza99_1",tt="_fileContent_vza99_3",nt="_addCommentButton_vza99_23",ot="_commentRow_vza99_46",st="_commentCell_vza99_50",L={diffContainer:et,fileContent:tt,"d2h-code-side-emptyplaceholder":"_d2h-code-side-emptyplaceholder_vza99_13","d2h-info":"_d2h-info_vza99_13",addCommentButton:nt,commentRow:ot,commentCell:st},rt="_container_1jkch_2",ct="_header_1jkch_14",at="_buttonGroup_1jkch_25",it="_content_1jkch_31",lt="_noHeader_1jkch_36",U={container:rt,header:ct,buttonGroup:at,content:it,noHeader:lt},ne=({header:e,buttons:o,children:s})=>t.jsxs("div",{className:U.container,children:[e&&t.jsxs("div",{className:U.header,children:[e,t.jsx("div",{className:U.buttonGroup,children:o})]}),t.jsx("div",{className:`${U.content} ${e?"":U.noHeader}`,children:s})]}),le=({content:e,onCopySuccess:o,onCopyError:s,defaultLabel:r="Copy",successLabel:n="Copied!",children:c=r,...a})=>{const[l,d]=m.useState(!1),C=async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(e);else{const f=document.createElement("textarea");f.value=e,f.style.top="0",f.style.left="0",f.style.position="fixed",f.style.opacity="0",document.body.appendChild(f),f.focus(),f.select(),document.execCommand("copy"),document.body.removeChild(f)}d(!0),o==null||o(),setTimeout(()=>d(!1),2e3)}catch(f){s==null||s(f)}};return t.jsx(W,{onClick:C,...a,children:l?n:c})},mt="_commentSection_fknn2_1",dt="_commentSectionHeader_fknn2_14",ut="_comment_fknn2_1",pt="_commentList_fknn2_33",ft="_commentWrapper_fknn2_41",ht="_deleteComment_fknn2_46",_t="_formHeader_fknn2_64",Ct="_commentContent_fknn2_69",yt="_commentHeader_fknn2_75",xt="_commentAuthor_fknn2_85",gt="_commentBody_fknn2_91",vt="_commentForm_fknn2_100",jt="_commentInput_fknn2_109",wt="_formFooter_fknn2_120",bt="_submitComment_fknn2_124",Nt="_closeButton_fknn2_136",St="_stickyComment_fknn2_151",R={commentSection:mt,commentSectionHeader:dt,comment:ut,commentList:pt,commentWrapper:ft,deleteComment:ht,formHeader:_t,commentContent:Ct,commentHeader:yt,commentAuthor:xt,commentBody:gt,commentForm:vt,commentInput:jt,formFooter:wt,submitComment:bt,closeButton:Nt,stickyComment:St},kt=({content:e,author:o,onDelete:s})=>t.jsx("div",{className:R.comment,children:t.jsx("div",{className:R.commentWrapper,children:t.jsxs("div",{className:R.commentContent,children:[t.jsxs("div",{className:R.commentHeader,children:[t.jsx("span",{className:R.commentAuthor,children:o}),t.jsx("button",{className:R.deleteComment,onClick:s,children:"×"})]}),t.jsx("div",{className:R.commentBody,children:e})]})})}),Ne=e=>{const[o,s]=m.useState(0),r=m.useRef(null);return m.useEffect(()=>{const n=d=>d?d.matches(e)?d:d.closest(e):null,c=()=>{const d=n(r.current);if(d){const C=d.scrollWidth;s(C)}},a=new ResizeObserver(c),l=n(r.current);return l&&a.observe(l),()=>{a.disconnect()}},[e]),[o,r]},Se=({onAddComment:e})=>{const[o,s]=m.useState(""),[r,n]=Ne(".d2h-auto-color-scheme"),c=a=>{a.preventDefault(),o.trim()&&(e(o),s(""))};return t.jsxs("form",{className:R.commentForm,onSubmit:c,ref:n,style:{width:r?`${r}px`:"100%",minWidth:"100%"},children:[t.jsx("textarea",{value:o,onChange:a=>s(a.target.value),placeholder:"Add a comment...",className:R.commentInput}),t.jsx("div",{className:R.formFooter,children:t.jsx("button",{onClick:c,className:R.submitComment,children:"Comment"})})]})},ke=({comments:e,onDeleteComment:o})=>{const[s,r]=Ne(".d2h-auto-color-scheme");return e.length?t.jsx("div",{className:R.commentList,ref:r,style:{width:s?`${s}px`:"100%"},children:e.map((n,c)=>t.jsx(kt,{...n,onDelete:()=>o(c)},c))}):null},$e=({content:e,filename:o,children:s="Deploy",...r})=>{const{uploadedFiles:n,config:c,files:a}=q(),{sendMessage:l,isLoading:d,response:C,streamingResult:f,setResponse:x}=X(`deploy-${o}`,"",{transformCompleteResponse:G}),y=te(f);return M.useEffect(()=>{x("")},[a]),c.deploySupportedFileExtensions.includes(o.split(".").pop())?C.url?t.jsx(le,{content:C.url,...r,children:"Deployed. Click to Copy!"}):t.jsx(W,{onClick:()=>l(ee(c.botName,"/deploy",{filename:o,files:n},{isCanvas:c.isCanvas})),...r,children:d?y||"Deploying":"Deploy"}):null},$t={drawFileList:!1,matching:"lines",outputFormat:"line-by-line",highlight:!1,colorScheme:"dark",renderNothingWhenEmpty:!0,rawTemplates:{"generic-wrapper":'<div class="d2h-auto-color-scheme">{{{content}}}</div>',"line-by-line-file-diff":`
            <div id="{{fileHtmlId}}" data-lang="{{file.language}}">
                <div class="d2h-file-list-wrapper">
                    <div class="d2h-file-list-header">
                        <span class="d2h-file-name-wrapper">
                            <span class="d2h-file-name">{{file.fileName}}</span>
                        </span>
                    </div>
                </div>
                <div class="d2h-file-diff">
                    <div class="d2h-code-wrapper">
                        <table class="d2h-diff-table">
                            <tbody class="d2h-diff-tbody">
                                {{{diffs}}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>`}},It=M.memo(({file:e,fileContent:o,commentsEnabled:s=!0})=>{const r=M.useRef(null),[n,c]=m.useState(null),a=M.useRef(null),[l,d]=m.useState([]),{addComment:C,deleteComment:f,getComments:x,getAllCommentsForFile:y}=ie(),_=m.useMemo(()=>({__html:Le([e],$t)}),[e]),i=m.useCallback(()=>{if(!r.current)return;(()=>{r.current.querySelectorAll(`.${L.commentRow}`).forEach(v=>{v!==a.current&&v.remove()})})();const z=y(e.newName).reduce((g,{lineInfo:v,comments:E})=>(g[v]=E,g),{}),D=[],b={};r.current.querySelectorAll(".d2h-code-linenumber").forEach(g=>{var O,I,N,A,S,P;const v=(N=(I=(O=g.querySelector(".line-num1"))==null?void 0:O.textContent)==null?void 0:I.trim)==null?void 0:N.call(I),H=((P=(S=(A=g.querySelector(".line-num2"))==null?void 0:A.textContent)==null?void 0:S.trim)==null?void 0:P.call(S))||v;b[H]||(b[H]=[]),b[H].push(g)}),Object.entries(b).forEach(([g,v])=>{const E=z[g];if(!(E!=null&&E.length))return;const O=(v[1]?v[1]:v[0]).closest("tr");if(!O)return;const I=O.closest("tbody");if(!I)return;const N=document.createElement("tr");N.className=`${L.commentRow}`,N.setAttribute("data-line",g);const A=document.createElement("div");A.className="portal-container";const S=document.createElement("td");S.className=`${L.commentCell}`,S.colSpan=3,S.appendChild(A),N.appendChild(S),O.nextSibling?I.insertBefore(N,O.nextSibling):I.appendChild(N),D.push(t.jsx(M.Fragment,{children:re.createPortal(t.jsx(ke,{comments:E,onDeleteComment:P=>f(e.newName,g,P)}),A)},`${e.newName}-${g}`))}),d(D)},[e.newName,y,f]);M.useEffect(()=>{setTimeout(async()=>{var $;if(r.current){const J=r.current.querySelectorAll(".d2h-code-linenumber"),z=(($=e.newName)==null?void 0:$.split(".").pop())||"";J.forEach(b=>{const g=b.closest("tr");if(!g.classList.contains("d2h-del")&&s){const v=document.createElement("button");v.className=L.addCommentButton,v.innerHTML="+",g.appendChild(v),g.addEventListener("mouseenter",()=>{v.style.opacity="1"}),g.addEventListener("mouseleave",()=>{v.style.opacity="0"}),v.addEventListener("click",E=>{var P,K,me,de,Z,ue;const H=(me=(K=(P=b.querySelector(".line-num1"))==null?void 0:P.textContent)==null?void 0:K.trim)==null?void 0:me.call(K),I=((ue=(Z=(de=b.querySelector(".line-num2"))==null?void 0:de.textContent)==null?void 0:Z.trim)==null?void 0:ue.call(Z))||H;if(n===I)return;a.current&&(a.current.remove(),a.current=null),c(I);const N=document.createElement("tr");N.className=L.commentRow,N.innerHTML=`<td colspan="3" class="${L.commentCell}"></td>`;const A=`.${L.commentRow}[data-line="${I}"]`,S=Array.from(r.current.querySelectorAll(A));if(S.length>0){const pe=S[S.length-1];pe.parentNode.insertBefore(N,pe.nextSibling)}else g.parentNode.insertBefore(N,g.nextSibling);a.current=N})}});const D=r.current.querySelectorAll(".d2h-code-line-ctn");D==null||D.forEach(b=>{b.dataset.highlighted||(ce.configure({ignoreUnescapedHTML:!0}),b.classList.add(`language-${z}`),ce.highlightElement(b))})}},0)},[_,e.newName,s,n]),M.useEffect(()=>{i()},[i]);const p=$=>{n&&(C(e.newName,n,$),i())},h=$=>{f(e.newName,n,$),i()},u=()=>{a.current&&(a.current.remove(),a.current=null),c(null)},j=e.isNew?e.newName:e.oldName,w=e.isRename?`${e.oldName} -> ${e.newName}`:j,k=t.jsxs(t.Fragment,{children:[t.jsx($e,{size:"small",filename:e.newName}),t.jsx(le,{size:"small",content:o})]});return t.jsx(ne,{header:w,buttons:k,children:t.jsxs("div",{className:L.diffContainer,children:[t.jsx("div",{className:L.fileContent,ref:r,dangerouslySetInnerHTML:_}),l,s&&n&&a.current&&re.createPortal(t.jsx(Se,{lineNumber:n,comments:x(e.newName,n),onAddComment:p,onDeleteComment:h,onClose:u}),a.current.querySelector(`.${L.commentCell}`))]})})}),Rt=({diff:e,files:o,commentsEnabled:s=!0})=>e?m.useMemo(()=>xe(e),[e]).map(n=>t.jsx(It,{file:n,fileContent:o[n.newName],commentsEnabled:s},n.newName)):null;const Lt="_container_1mk1f_1",Bt="_codeWrapper_1mk1f_7",Ft="_inlineCommentSection_1mk1f_16",Dt="_codeLine_1mk1f_21",Et="_lineNumber_1mk1f_35",Ot="_hoverable_1mk1f_48",At="_lineContent_1mk1f_57",Mt="_addCommentButton_1mk1f_61",F={container:Lt,codeWrapper:Bt,inlineCommentSection:Ft,codeLine:Dt,lineNumber:Et,hoverable:Ot,lineContent:At,addCommentButton:Mt},Pt=e=>{const o=e.split(".").pop().toLowerCase();return{js:"javascript",jsx:"javascript",ts:"typescript",tsx:"typescript",py:"python",rb:"ruby",java:"java",cpp:"cpp",c:"c",cs:"csharp",html:"html",css:"css",scss:"scss",sass:"scss",php:"php",go:"go",rs:"rust",swift:"swift",kt:"kotlin",md:"markdown",json:"json",xml:"xml",yaml:"yaml",yml:"yaml",sql:"sql",sh:"bash",bash:"bash",dockerfile:"dockerfile"}[o]||"plaintext"},Tt=({lineNumber:e,content:o,commentsEnabled:s,onLineSelect:r,language:n,selectedLine:c,existingComments:a,onAddComment:l,onDeleteComment:d,onClose:C})=>{const[f,x]=m.useState(!1),y=m.useRef(null);return m.useEffect(()=>{!y.current||y.current.dataset.highlighted==="yes"||ce.highlightElement(y.current)},[o]),t.jsxs("div",{className:F.lineContainer,children:[t.jsxs("div",{className:F.codeLine,"data-line":e,onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),onClick:()=>r(e),children:[t.jsx("span",{className:`${F.lineNumber}${s?" "+F.hoverable:""}`,children:String(e).padStart(3)}),t.jsx("span",{ref:y,className:`${F.lineContent} language-${n}`,children:o}),s&&t.jsx("button",{className:F.addCommentButton,style:{opacity:f?1:0},onClick:_=>{_.stopPropagation(),r(e)},children:"+"})]}),a&&a.length>0&&t.jsx("div",{className:F.existingComments,children:t.jsx(ke,{comments:a,onDeleteComment:_=>d(_)})}),c===e&&s&&t.jsx(Se,{lineNumber:e,comments:a||[],onAddComment:l,onDeleteComment:d,onClose:C})]})},ye=({filename:e,content:o,commentsEnabled:s=!0})=>{const[r,n]=m.useState(null),{addComment:c,deleteComment:a,getAllCommentsForFile:l}=ie(),d=Pt(e),C=o.split(`
`),f=t.jsxs(t.Fragment,{children:[t.jsx($e,{size:"small",filename:e}),t.jsx(le,{size:"small",content:o})]}),y=l(e).reduce((p,{lineInfo:h,comments:u})=>(p[h]=u,p),{}),_=(p,h)=>{c(e,p,h)},i=(p,h)=>{a(e,p,h)};return t.jsx(ne,{header:e,buttons:f,children:t.jsx("div",{className:F.container,children:t.jsx("pre",{className:F.codeWrapper,children:t.jsx("code",{className:`language-${d}`,children:C.map((p,h)=>{const u=h+1,j=y[u]||[];return t.jsx(Tt,{lineNumber:u,content:p,commentsEnabled:s,onLineSelect:n,language:d,selectedLine:r,existingComments:j,onAddComment:w=>_(u,w),onDeleteComment:w=>i(u,w),onClose:()=>n(null)},u)})})})})})},Ht="_container_7qw4f_2",Wt={container:Ht},qt="_diffDescription_guii0_2",zt={diffDescription:qt},Ie=({markdown:e=""})=>t.jsx("div",{className:"markdown-container prose prose-sm sm:prose lg:prose-lg max-w-none",dangerouslySetInnerHTML:{__html:Re(e)}}),Ut=({description:e})=>e?t.jsx(ne,{children:t.jsx("div",{className:zt.diffDescription,children:t.jsx(Ie,{markdown:e})})}):null;function Gt(e){return e?xe(e).map(o=>o.newName):[]}const Jt="_container_r5p9y_1",Kt="_commentForm_r5p9y_7",Zt="_commentInput_r5p9y_11",se={container:Jt,commentForm:Kt,commentInput:Zt},Vt=({children:e})=>{const{addGlobalComment:o,getGlobalComment:s}=ie(),r=s(),n=c=>{const a=c.target.value;o(a)};return t.jsx(ne,{header:"Comment",children:t.jsxs("div",{className:se.container,children:[t.jsx("div",{className:se.commentForm,children:t.jsx("textarea",{value:r,onChange:n,placeholder:"What would you like to do?",className:se.commentInput})}),e]})})},Yt="_overlay_yjpva_1",Qt="_content_yjpva_15",Xt="_spinner_yjpva_31",en="_spin_yjpva_31",V={overlay:Yt,content:Qt,spinner:Xt,spin:en};function tn({text:e="Loading...",isVisible:o=!0}){return o?t.jsx("div",{className:V.overlay,children:t.jsxs("div",{className:V.content,children:[t.jsx("div",{className:V.spinner}),t.jsx("div",{className:V.text,children:t.jsx(Ie,{markdown:e})})]})}):null}const nn="_container_dn3w7_1",on="_actions_dn3w7_8",sn="_menuIcon_dn3w7_16",rn="_menuIconOpen_dn3w7_22",cn="_menuButton_dn3w7_27",an="_dropdown_dn3w7_49",ln="_slideIn_dn3w7_1",mn="_dropdownContainer_dn3w7_53",dn="_dropdownInner_dn3w7_65",un="_dropdownItem_dn3w7_69",B={container:nn,actions:on,menuIcon:sn,menuIconOpen:rn,menuButton:cn,dropdown:an,slideIn:ln,dropdownContainer:mn,dropdownInner:dn,dropdownItem:un},pn="_buttonGroup_1l8fr_2",fn="_copyButton_1l8fr_8",Y={buttonGroup:pn,copyButton:fn},hn=({shareUrl:e})=>{if(!e)return null;const o=async(r,n,c,a)=>{if(!(!n||!r))try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(r);else{const l=document.createElement("textarea");l.value=r,l.style.position="fixed",l.style.left="-999999px",l.style.top="-999999px",document.body.appendChild(l),l.focus(),l.select();try{document.execCommand("copy")}finally{l.remove()}}n.textContent=a,setTimeout(()=>{n.textContent=c},2e3)}catch(l){console.error("Failed to copy:",l),n.textContent="Copy failed",setTimeout(()=>{n.textContent=c},2e3)}},s=r=>{r&&(r.preventDefault(),r.stopPropagation());const n=document.querySelector(`.${Y.shareButton}`);if(!n){console.error("Share button not found");return}o(e,n,"Share","Link copied!")};return t.jsx("div",{className:Y.buttonGroup,children:t.jsx("button",{className:`${Y.copyButton} ${Y.shareButton}`,onClick:s,children:"Share"})})},_n=({afterApply:e,...o})=>{const{sendMessage:s,isLoading:r,response:n,streamingResult:c}=X("apply_diff_llm","",{transformCompleteResponse:G}),{setResponse:a,config:l,diff:d}=q(),C=te(c);return m.useEffect(()=>{n&&(a(n),e==null||e())},[n]),d?t.jsx(W,{onClick:()=>s(ee(l.botName,"/apply_diff_llm",{},{isCanvas:l.isCanvas})),...o,children:r?C||"Applying diff":"Looks weird? Apply diff using LLM."}):null},Cn=({afterApply:e,...o})=>{const{sendMessage:s,isLoading:r,response:n,streamingResult:c}=X("review","",{transformCompleteResponse:G}),{setResponse:a,config:l,uploadedFiles:d,files:C}=q(),f=te(c);return m.useEffect(()=>{n&&(console.log(n),a(n),e==null||e())},[n]),!d&&!C?null:t.jsx(W,{onClick:()=>s(ee(l.botName,"/review",{files:d},{isCanvas:l.isCanvas})),...o,children:r?f||"Reviewing the code...":"Code review"})},yn=({shareUrl:e})=>{const[o,s]=m.useState(!1),r=m.useRef(null),{config:n}=q();m.useEffect(()=>{const a=l=>{r.current&&!r.current.contains(l.target)&&s(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);const c=()=>{s(!1)};return t.jsx("div",{className:B.container,children:t.jsxs("div",{className:B.actions,children:[t.jsx(hn,{shareUrl:e||`https://poe.com/${n.botName}`}),t.jsxs("div",{className:"relative inline-block",ref:r,children:[t.jsx(W,{variant:"ghost",size:"small",className:B.menuButton,onClick:()=>s(!o),"aria-expanded":o,children:t.jsxs("svg",{className:`${B.menuIcon} ${o?B.menuIconOpen:""}`,width:"16",height:"16",viewBox:"0 0 16 16",children:[t.jsx("circle",{cx:"8",cy:"4",r:"1.5"}),t.jsx("circle",{cx:"8",cy:"8",r:"1.5"}),t.jsx("circle",{cx:"8",cy:"12",r:"1.5"})]})}),o&&t.jsx("div",{className:`${B.dropdownContainer} ${B.dropdown}`,children:t.jsxs("div",{className:B.dropdownInner,children:[t.jsx(_n,{className:B.dropdownItem,afterApply:c}),t.jsx(Cn,{className:B.dropdownItem,afterApply:c})]})})]})]})})},xn=()=>{const{uploadedFiles:e,setUploadedFiles:o,files:s,diff:r,config:n,description:c,isLoading:a,statusText:l,isInitialData:d}=q(),C=Gt(r),f=Object.keys(s).reduce((i,p)=>(C.includes(p)||(i[p]=s[p]),i),{}),x=async i=>{try{const p=u=>new Promise((j,w)=>{const k=new FileReader;k.onload=()=>j(k.result),k.onerror=w,k.readAsText(u)}),h=await Promise.all(Array.from(i).map(async u=>[u.name,await p(u)]));o(u=>({...u,...Object.fromEntries(h)}))}catch(p){console.error("Error reading files:",p)}},y=i=>{o(p=>{const h={...p};return delete h[i],h})},_=`# 🚀 ${n.botName}
🤯 Tired of AI bots playing hide-and-seek with your code?
Finally! A way to get AI code assistant without the endless "..." or "code continues here" nonsense. Just upload, ask, and get the job done. Simple as that! ⚡️
`;return t.jsxs("div",{className:Wt.container,children:[t.jsx(yn,{shareUrl:d?n.shareUrl:null}),t.jsx(tn,{isVisible:a,text:l}),t.jsx(Ut,{description:n.isInitialPage?_:c}),n.shouldShowUpload&&t.jsx(Te,{onFilesDrop:x,children:t.jsx(Ce,{uploadedFiles:e,size:"large",children:"Send message"})}),t.jsx(Rt,{diff:r,files:s,commentsEnabled:n.shouldShowComments}),Object.keys(f).map(i=>t.jsx(ye,{filename:i,content:f[i],commentsEnabled:n.shouldShowComments},i)),Object.keys(e).map(i=>t.jsx(ye,{filename:i,content:e[i],onRemove:()=>y(i),commentsEnabled:n.shouldShowComments},i)),n.shouldShowComments&&t.jsx(Vt,{children:t.jsx(Ce,{uploadedFiles:e,size:"large",children:"Send message"})})]})},gn=JSON.parse(document.getElementById("config-json-data").textContent),vn=JSON.parse(document.getElementById("files-json-data").textContent),jn=JSON.parse(document.getElementById("diff-json-data").textContent),wn=JSON.parse(document.getElementById("comments-json-data").textContent);ae.createRoot(document.getElementById("root")).render(t.jsx(M.StrictMode,{children:t.jsx(Xe,{initialFiles:vn,initialComments:wn,initialDiff:jn,config:gn,children:t.jsx(xn,{})})}));
