import{r as m,a as ce,R as P,m as Pe}from"./assets/vendor-891a2f54.js";import{h as Te,p as ye}from"./assets/diff2html-520d79da.js";import{H as y,j as xe,x as ve,c as je,p as we,g as be,t as Ne,a as Se,b as $e,s as Le}from"./assets/hljs-0651ac0c.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function o(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(n){if(n.ep)return;n.ep=!0;const c=o(n);fetch(n.href,c)}})();var Ie={exports:{}},X={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ze=m,We=Symbol.for("react.element"),He=Symbol.for("react.fragment"),qe=Object.prototype.hasOwnProperty,Ue=ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ge={key:!0,ref:!0,__self:!0,__source:!0};function Re(e,s,o){var r,n={},c=null,a=null;o!==void 0&&(c=""+o),s.key!==void 0&&(c=""+s.key),s.ref!==void 0&&(a=s.ref);for(r in s)qe.call(s,r)&&!Ge.hasOwnProperty(r)&&(n[r]=s[r]);if(e&&e.defaultProps)for(r in s=e.defaultProps,s)n[r]===void 0&&(n[r]=s[r]);return{$$typeof:We,type:e,key:c,ref:a,props:n,_owner:Ue.current}}X.Fragment=He;X.jsx=Re;X.jsxs=Re;Ie.exports=X;var t=Ie.exports,ae={},fe=ce;ae.createRoot=fe.createRoot,ae.hydrateRoot=fe.hydrateRoot;const Je="_container_1kx9n_2",Ke="_uploadZone_1kx9n_10",he={container:Je,uploadZone:Ke},Ze=({onFilesDrop:e,children:s})=>{const o=a=>{a.preventDefault(),a.currentTarget.style.borderColor="#0969da"},r=a=>{a.currentTarget.style.borderColor="#30363d"},n=a=>{a.preventDefault(),a.currentTarget.style.borderColor="#30363d",e(a.dataTransfer.files)},c=a=>{e(a.target.files),a.target.value=""};return t.jsxs("div",{className:he.container,children:[t.jsxs("div",{className:he.uploadZone,onDragOver:o,onDragLeave:r,onDrop:n,onClick:()=>document.getElementById("fileInput").click(),children:[t.jsx("p",{children:"Drag and drop your source code files here or click to select"}),t.jsx("input",{type:"file",id:"fileInput",style:{display:"none"},multiple:!0,onChange:c})]}),s]})},Ve="_button_nc3y6_2",Ye="_small_nc3y6_15",Qe="_medium_nc3y6_22",Xe="_large_nc3y6_29",et="_primary_nc3y6_47",tt="_success_nc3y6_56",nt="_danger_nc3y6_65",st="_ghost_nc3y6_75",oe={button:Ve,small:Ye,medium:Qe,large:Xe,default:"_default_nc3y6_37",primary:et,success:tt,danger:nt,ghost:st},H=({variant:e="default",size:s="medium",disabled:o=!1,type:r="button",onClick:n,children:c,className:a,...i})=>{const d=[oe.button,oe[e],oe[s],a].filter(Boolean).join(" ");return t.jsx("button",{type:r,className:d,onClick:n,disabled:o,...i,children:c})},ot="_buttonWrapper_17g1b_1",rt={buttonWrapper:ot};function ee(e,s,{openChat:o=!1,stream:r=!0,transformCompleteResponse:n=c=>c}={}){const[c,a]=m.useState(s),[i,d]=m.useState(s),[g,f]=m.useState(!1),[x,C]=m.useState(null),[_,l]=m.useState(!1);m.useEffect(()=>{if(!window.Poe){console.info("Poe not found in window object");return}return window.Poe.registerHandler(e,h=>{const u=h.responses[0];u.status==="error"?(C(u.statusText),a(s),f(!0),l(!1)):u.status==="incomplete"?(l(!0),d(u.content)):u.status==="complete"&&(l(!1),a(n(u.content)),d(u.content))})},[]);const p=m.useCallback(async h=>{if(h!=null&&h.trim()){l(!0),f(!1),C(null);try{if(console.log(h),!window.Poe){console.info("Poe not found in window object");return}await window.Poe.sendUserMessage(h,{handler:e,stream:r,openChat:o})}catch(u){console.log(u),f(!0),C(u)}}},[e,o,r]);return{sendMessage:p,sendUserMessage:p,response:c,setResponse:a,isError:g,error:x,isLoading:_,streamingResult:i}}const te=(e,s,o,{isCanvas:r=!1}={})=>{const n=`@${e} ${s}`,c=JSON.stringify({...o,format:r?"json":"code"});return`${n}
~~~
${c}`},J=e=>{console.log(e);const s=e.replace(/\n\n---\n\n\[Logs\]\([^\)]+\)/g,"");return console.log(s),JSON.parse(s)},ne=e=>m.useMemo(()=>{try{const o=JSON.parse(e);if(o.status)return o.status}catch{}},[e]),ke=m.createContext(),z="~~~",Fe=(e,s)=>{if(!e)return[];let o=Object.entries(e).map(([r,n])=>{const[c,a]=r.split(z);return{fileName:c,lineInfo:a,comments:n}});return s!=null&&s.content&&(o=[...o,{fileName:"global",lineInfo:"global",comments:[s]}]),o=o.filter(({comments:r})=>r.length),o},ct=e=>typeof e=="object"&&e!==null&&!Array.isArray(e),ge=e=>{if(ct(e))return e;const s={};return e.forEach(o=>{if(o.fileName==="global"&&o.lineInfo==="global")return;const r=o.comments.map(c=>({id:c.id,author:c.author,content:c.content||c.Bot})),n=`${o.fileName}${z}${o.lineInfo}`;s[n]=r}),s},at=({comments:e,setComments:s,globalComment:o,setGlobalComment:r,children:n})=>{const c=(_,l,p)=>{const h=`${_}${z}${l}`,u={id:Date.now(),content:p,author:"User"};s(w=>({...w,[h]:[...w[h]||[],u]}))},a=_=>{const l={id:Date.now(),content:_,author:"User"};r(l)},i=()=>(o==null?void 0:o.content)||"",d=(_,l,p,h)=>{const u=`${_}${z}${l}`;s(w=>({...w,[u]:w[u].map((b,L)=>L===p?{...b,content:h}:b)}))},g=(_,l,p)=>{const h=`${_}${z}${l}`;s(u=>({...u,[h]:u[h].filter((w,b)=>b!==p)}))},f=(_,l)=>{const p=`${_}-${l}`;return e[p]||[]},x=m.useCallback(()=>Fe(e,o),[e,o]),C=m.useCallback(_=>e?Object.entries(e).filter(([p])=>p.startsWith(`${_}${z}`)).map(([p,h])=>({lineInfo:p.split(z)[1],comments:h})):[],[e]);return t.jsx(ke.Provider,{value:{addComment:c,deleteComment:g,updateComment:d,getComments:f,getAllComments:x,addGlobalComment:a,getGlobalComment:i,getAllCommentsForFile:C},children:n})},ie=()=>m.useContext(ke),Be=m.createContext(null);function it({children:e,initialFiles:s,initialComments:o,initialDiff:r,config:n}){const[c,a]=m.useState({}),[i,d]=m.useState(ge(o)),[g,f]=m.useState(),[x,C]=m.useState(n),_=m.useMemo(()=>Fe(i,g),[i,g]),{response:l,isLoading:p,sendMessage:h,streamingResult:u,setResponse:w}=ee("store",{isInitialData:!0,files:s,comments:null,diff:r,description:x.description},{transformCompleteResponse:J}),b=ne(u),L=!!Object.keys(c).length,I=m.useMemo(()=>!!_.length,[_]),K=m.useCallback(()=>{if(!L&&!I)return;const N=te(x.botName,"/update",{files:c,comments:_},{isCanvas:x.isCanvas});h(N,{transformCompleteResponse:J})},[c,_,L,I,g,i]),U=L||I;m.useEffect(()=>{l.isInitialData||(Array.isArray(l.comments)?d(ge(l.comments)):d(l.comments||{}),f(""),a({}),C({...x,shouldShowUpload:!1,isInitialPage:!1}))},[l]);const E={config:x,uploadedFiles:c,setUploadedFiles:a,sendSubmitMessage:K,canSubmitMessage:U,files:l.files,isLoading:p,diff:l.diff,description:l.description,statusText:b,setResponse:w,isInitialData:l.isInitialData};return t.jsx(Be.Provider,{value:E,children:t.jsx(at,{setComments:d,setGlobalComment:f,globalComment:g,comments:i,children:e})})}function q(){return m.useContext(Be)}JSON.parse(document.getElementById("config-json-data").textContent);const _e=({uploadedFiles:e,onSubmit:s,children:o,...r})=>{const{sendSubmitMessage:n,canSubmitMessage:c}=q();return t.jsx("div",{className:rt.buttonWrapper,children:t.jsx(H,{onClick:n,disabled:!c,variant:"success",...r,children:o})})};const lt="_diffContainer_vza99_1",mt="_fileContent_vza99_3",dt="_addCommentButton_vza99_23",ut="_commentRow_vza99_46",pt="_commentCell_vza99_50",F={diffContainer:lt,fileContent:mt,"d2h-code-side-emptyplaceholder":"_d2h-code-side-emptyplaceholder_vza99_13","d2h-info":"_d2h-info_vza99_13",addCommentButton:dt,commentRow:ut,commentCell:pt},ft="_container_1jkch_2",ht="_header_1jkch_14",gt="_buttonGroup_1jkch_25",_t="_content_1jkch_31",Ct="_noHeader_1jkch_36",G={container:ft,header:ht,buttonGroup:gt,content:_t,noHeader:Ct},se=({header:e,buttons:s,children:o})=>t.jsxs("div",{className:G.container,children:[e&&t.jsxs("div",{className:G.header,children:[e,t.jsx("div",{className:G.buttonGroup,children:s})]}),t.jsx("div",{className:`${G.content} ${e?"":G.noHeader}`,children:o})]}),le=({content:e,onCopySuccess:s,onCopyError:o,defaultLabel:r="Copy",successLabel:n="Copied!",children:c=r,...a})=>{const[i,d]=m.useState(!1),g=async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(e);else{const f=document.createElement("textarea");f.value=e,f.style.top="0",f.style.left="0",f.style.position="fixed",f.style.opacity="0",document.body.appendChild(f),f.focus(),f.select(),document.execCommand("copy"),document.body.removeChild(f)}d(!0),s==null||s(),setTimeout(()=>d(!1),2e3)}catch(f){o==null||o(f)}};return t.jsx(H,{onClick:g,...a,children:i?n:c})},yt="_comment_165zu_1",xt="_commentList_165zu_12",vt="_commentWrapper_165zu_23",jt="_deleteComment_165zu_28",wt="_commentContent_165zu_46",bt="_commentHeader_165zu_54",Nt="_commentAuthor_165zu_64",St="_commentBody_165zu_70",$t="_commentForm_165zu_80",Lt="_commentInput_165zu_89",It="_formFooter_165zu_100",Rt="_submitComment_165zu_104",k={comment:yt,commentList:xt,commentWrapper:vt,deleteComment:jt,commentContent:wt,commentHeader:bt,commentAuthor:Nt,commentBody:St,commentForm:$t,commentInput:Lt,formFooter:It,submitComment:Rt},kt=({content:e,author:s,onDelete:o})=>t.jsx("div",{className:k.comment,children:t.jsx("div",{className:k.commentWrapper,children:t.jsxs("div",{className:k.commentContent,children:[t.jsxs("div",{className:k.commentHeader,children:[t.jsx("span",{className:k.commentAuthor,children:s}),t.jsx("button",{className:k.deleteComment,onClick:o,children:"×"})]}),t.jsx("div",{className:k.commentBody,children:e})]})})}),De=e=>{const[s,o]=m.useState(0),r=m.useRef(null);return m.useEffect(()=>{const n=d=>d?d.matches(e)?d:d.closest(e):null,c=()=>{const d=n(r.current);if(d){const g=d.scrollWidth;o(g)}},a=new ResizeObserver(c),i=n(r.current);return i&&a.observe(i),()=>{a.disconnect()}},[e]),[s,r]},Ee=({onAddComment:e})=>{const[s,o]=m.useState(""),[r,n]=De(".d2h-auto-color-scheme, .code-viewer-wrapper"),c=a=>{a.preventDefault(),s.trim()&&(e(s),o(""))};return t.jsxs("form",{className:k.commentForm,onSubmit:c,ref:n,style:{width:r?`${r}px`:"100%"},children:[t.jsx("textarea",{value:s,onChange:a=>o(a.target.value),placeholder:"Add a comment...",className:k.commentInput}),t.jsx("div",{className:k.formFooter,children:t.jsx("button",{onClick:c,className:k.submitComment,children:"Comment"})})]})},Oe=({comments:e,onDeleteComment:s})=>{const[o,r]=De(".d2h-auto-color-scheme, .code-viewer-wrapper");return e.length?t.jsx("div",{className:k.commentList,ref:r,style:{width:o?`${o}px`:"100%"},children:e.map((n,c)=>t.jsx(kt,{...n,onDelete:()=>s(c)},c))}):null},Ae=({content:e,filename:s,children:o="Deploy",...r})=>{const{uploadedFiles:n,config:c,files:a}=q(),{sendMessage:i,isLoading:d,response:g,streamingResult:f,setResponse:x}=ee(`deploy-${s}`,"",{transformCompleteResponse:J}),C=ne(f);return P.useEffect(()=>{x("")},[a]),c.deploySupportedFileExtensions.includes(s.split(".").pop())?g.url?t.jsx(le,{content:g.url,...r,children:"Deployed. Click to Copy!"}):t.jsx(H,{onClick:()=>i(te(c.botName,"/deploy",{filename:s,files:n},{isCanvas:c.isCanvas})),...r,children:d?C||"Deploying":"Deploy"}):null};y.registerLanguage("javascript",xe);y.registerLanguage("html",ve);y.registerLanguage("css",je);y.registerLanguage("python",we);y.registerLanguage("go",be);y.registerLanguage("typescript",Ne);y.registerLanguage("json",Se);y.registerLanguage("bash",$e);y.registerLanguage("sql",Le);const Ft={drawFileList:!1,matching:"lines",outputFormat:"line-by-line",highlight:!1,colorScheme:"dark",renderNothingWhenEmpty:!0,rawTemplates:{"generic-wrapper":'<div class="d2h-auto-color-scheme">{{{content}}}</div>',"line-by-line-file-diff":`
            <div id="{{fileHtmlId}}" data-lang="{{file.language}}">
                <div class="d2h-file-list-wrapper">
                    <div class="d2h-file-list-header">
                        <span class="d2h-file-name-wrapper">
                            <span class="d2h-file-name">{{file.fileName}}</span>
                        </span>
                    </div>
                </div>
                <div class="d2h-file-diff">
                    <div class="d2h-code-wrapper">
                        <table class="d2h-diff-table">
                            <tbody class="d2h-diff-tbody">
                                {{{diffs}}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>`}},Bt=P.memo(({file:e,fileContent:s,commentsEnabled:o=!0})=>{const r=P.useRef(null),[n,c]=m.useState(null),a=P.useRef(null),[i,d]=m.useState([]),{addComment:g,deleteComment:f,getComments:x,getAllCommentsForFile:C}=ie(),_=m.useMemo(()=>({__html:Te([e],Ft)}),[e]),l=m.useCallback(()=>{if(!r.current)return;(()=>{r.current.querySelectorAll(`.${F.commentRow}`).forEach(j=>{j!==a.current&&j.remove()})})();const U=C(e.newName).reduce((v,{lineInfo:j,comments:O})=>(v[j]=O,v),{}),E=[],N={};r.current.querySelectorAll(".d2h-code-linenumber").forEach(v=>{var A,R,S,M,$,T;const j=(S=(R=(A=v.querySelector(".line-num1"))==null?void 0:A.textContent)==null?void 0:R.trim)==null?void 0:S.call(R),W=((T=($=(M=v.querySelector(".line-num2"))==null?void 0:M.textContent)==null?void 0:$.trim)==null?void 0:T.call($))||j;N[W]||(N[W]=[]),N[W].push(v)}),Object.entries(N).forEach(([v,j])=>{const O=U[v];if(!(O!=null&&O.length))return;const A=(j[1]?j[1]:j[0]).closest("tr");if(!A)return;const R=A.closest("tbody");if(!R)return;const S=document.createElement("tr");S.className=`${F.commentRow}`,S.setAttribute("data-line",v);const M=document.createElement("div");M.className="portal-container";const $=document.createElement("td");$.className=`${F.commentCell}`,$.colSpan=3,$.appendChild(M),S.appendChild($),A.nextSibling?R.insertBefore(S,A.nextSibling):R.appendChild(S),E.push(t.jsx(P.Fragment,{children:ce.createPortal(t.jsx(Oe,{comments:O,onDeleteComment:T=>f(e.newName,v,T)}),M)},`${e.newName}-${v}`))}),d(E)},[e.newName,C,f]);P.useEffect(()=>{setTimeout(async()=>{var I;if(r.current){const K=r.current.querySelectorAll(".d2h-code-linenumber"),U=((I=e.newName)==null?void 0:I.split(".").pop())||"";K.forEach(N=>{const v=N.closest("tr");if(!v.classList.contains("d2h-del")&&o){const j=document.createElement("button");j.className=F.addCommentButton,j.innerHTML="+",v.appendChild(j),v.addEventListener("mouseenter",()=>{j.style.opacity="1"}),v.addEventListener("mouseleave",()=>{j.style.opacity="0"}),j.addEventListener("click",O=>{var T,Z,me,de,V,ue;const W=(me=(Z=(T=N.querySelector(".line-num1"))==null?void 0:T.textContent)==null?void 0:Z.trim)==null?void 0:me.call(Z),R=((ue=(V=(de=N.querySelector(".line-num2"))==null?void 0:de.textContent)==null?void 0:V.trim)==null?void 0:ue.call(V))||W;if(n===R)return;a.current&&(a.current.remove(),a.current=null),c(R);const S=document.createElement("tr");S.className=F.commentRow,S.innerHTML=`<td colspan="3" class="${F.commentCell}"></td>`;const M=`.${F.commentRow}[data-line="${R}"]`,$=Array.from(r.current.querySelectorAll(M));if($.length>0){const pe=$[$.length-1];pe.parentNode.insertBefore(S,pe.nextSibling)}else v.parentNode.insertBefore(S,v.nextSibling);a.current=S})}});const E=r.current.querySelectorAll(".d2h-code-line-ctn");E==null||E.forEach(N=>{N.dataset.highlighted||(y.configure({ignoreUnescapedHTML:!0}),N.classList.add(`language-${U}`),y.highlightElement(N))})}},0)},[_,e.newName,o,n]),P.useEffect(()=>{l()},[l]);const p=I=>{n&&(g(e.newName,n,I),l())},h=I=>{f(e.newName,n,I),l()},u=()=>{a.current&&(a.current.remove(),a.current=null),c(null)},w=e.isNew?e.newName:e.oldName,b=e.isRename?`${e.oldName} -> ${e.newName}`:w,L=t.jsxs(t.Fragment,{children:[t.jsx(Ae,{size:"small",filename:e.newName}),t.jsx(le,{size:"small",content:s})]});return t.jsx(se,{header:b,buttons:L,children:t.jsxs("div",{className:F.diffContainer,children:[t.jsx("div",{className:F.fileContent,ref:r,dangerouslySetInnerHTML:_}),i,o&&n&&a.current&&ce.createPortal(t.jsx(Ee,{lineNumber:n,comments:x(e.newName,n),onAddComment:p,onDeleteComment:h,onClose:u}),a.current.querySelector(`.${F.commentCell}`))]})})}),Dt=({diff:e,files:s,commentsEnabled:o=!0})=>e?m.useMemo(()=>ye(e),[e]).map(n=>t.jsx(Bt,{file:n,fileContent:s[n.newName],commentsEnabled:o},n.newName)):null;const Et="_container_1mk1f_1",Ot="_codeWrapper_1mk1f_7",At="_inlineCommentSection_1mk1f_16",Mt="_codeLine_1mk1f_21",Pt="_lineNumber_1mk1f_35",Tt="_hoverable_1mk1f_48",zt="_lineContent_1mk1f_57",Wt="_addCommentButton_1mk1f_61",D={container:Et,codeWrapper:Ot,inlineCommentSection:At,codeLine:Mt,lineNumber:Pt,hoverable:Tt,lineContent:zt,addCommentButton:Wt};y.registerLanguage("javascript",xe);y.registerLanguage("html",ve);y.registerLanguage("css",je);y.registerLanguage("python",we);y.registerLanguage("go",be);y.registerLanguage("typescript",Ne);y.registerLanguage("json",Se);y.registerLanguage("bash",$e);y.registerLanguage("sql",Le);const Ht=e=>{const s=e.split(".").pop().toLowerCase();return{js:"javascript",jsx:"javascript",ts:"typescript",tsx:"typescript",py:"python",rb:"ruby",java:"java",cpp:"cpp",c:"c",cs:"csharp",html:"html",css:"css",scss:"scss",sass:"scss",php:"php",go:"go",rs:"rust",swift:"swift",kt:"kotlin",md:"markdown",json:"json",xml:"xml",yaml:"yaml",yml:"yaml",sql:"sql",sh:"bash",bash:"bash",dockerfile:"dockerfile"}[s]||"plaintext"},qt=({lineNumber:e,content:s,commentsEnabled:o,onLineSelect:r,language:n,selectedLine:c,existingComments:a,onAddComment:i,onDeleteComment:d,onClose:g})=>{const[f,x]=m.useState(!1),C=m.useRef(null);return m.useEffect(()=>{!C.current||C.current.dataset.highlighted==="yes"||y.highlightElement(C.current)},[s]),t.jsxs("div",{className:D.lineContainer,children:[t.jsxs("div",{className:D.codeLine,"data-line":e,onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),onClick:()=>r(e),children:[t.jsx("span",{className:`${D.lineNumber}${o?" "+D.hoverable:""}`,children:String(e).padStart(3)}),t.jsx("span",{ref:C,className:`${D.lineContent} language-${n}`,children:s}),o&&t.jsx("button",{className:D.addCommentButton,style:{opacity:f?1:0},onClick:_=>{_.stopPropagation(),r(e)},children:"+"})]}),a&&a.length>0&&t.jsx("div",{className:D.existingComments,children:t.jsx(Oe,{comments:a,onDeleteComment:_=>d(_)})}),c===e&&o&&t.jsx(Ee,{lineNumber:e,comments:a||[],onAddComment:i,onDeleteComment:d,onClose:g})]})},Ce=({filename:e,content:s,commentsEnabled:o=!0})=>{const[r,n]=m.useState(null),{addComment:c,deleteComment:a,getAllCommentsForFile:i}=ie(),d=Ht(e),g=s.split(`
`),f=t.jsxs(t.Fragment,{children:[t.jsx(Ae,{size:"small",filename:e}),t.jsx(le,{size:"small",content:s})]}),C=i(e).reduce((p,{lineInfo:h,comments:u})=>(p[h]=u,p),{}),_=(p,h)=>{c(e,p,h)},l=(p,h)=>{a(e,p,h)};return t.jsx(se,{header:e,buttons:f,children:t.jsx("div",{className:D.container,children:t.jsx("pre",{className:`${D.codeWrapper} code-viewer-wrapper`,children:t.jsx("code",{className:`language-${d}`,children:g.map((p,h)=>{const u=h+1,w=C[u]||[];return t.jsx(qt,{lineNumber:u,content:p,commentsEnabled:o,onLineSelect:n,language:d,selectedLine:r,existingComments:w,onAddComment:b=>_(u,b),onDeleteComment:b=>l(u,b),onClose:()=>n(null)},u)})})})})})},Ut="_container_7qw4f_2",Gt={container:Ut},Jt="_diffDescription_guii0_2",Kt={diffDescription:Jt},Me=({markdown:e=""})=>t.jsx("div",{className:"markdown-container prose prose-sm sm:prose lg:prose-lg max-w-none",dangerouslySetInnerHTML:{__html:Pe(e)}}),Zt=({description:e})=>e?t.jsx(se,{children:t.jsx("div",{className:Kt.diffDescription,children:t.jsx(Me,{markdown:e})})}):null;function Vt(e){return e?ye(e).map(s=>s.newName):[]}const Yt="_container_r5p9y_1",Qt="_commentForm_r5p9y_7",Xt="_commentInput_r5p9y_11",re={container:Yt,commentForm:Qt,commentInput:Xt},en=({children:e})=>{const{addGlobalComment:s,getGlobalComment:o}=ie(),r=o(),n=c=>{const a=c.target.value;s(a)};return t.jsx(se,{header:"Comment",children:t.jsxs("div",{className:re.container,children:[t.jsx("div",{className:re.commentForm,children:t.jsx("textarea",{value:r,onChange:n,placeholder:"What would you like to do?",className:re.commentInput})}),e]})})},tn="_overlay_yjpva_1",nn="_content_yjpva_15",sn="_spinner_yjpva_31",on="_spin_yjpva_31",Y={overlay:tn,content:nn,spinner:sn,spin:on};function rn({text:e="Loading...",isVisible:s=!0}){return s?t.jsx("div",{className:Y.overlay,children:t.jsxs("div",{className:Y.content,children:[t.jsx("div",{className:Y.spinner}),t.jsx("div",{className:Y.text,children:t.jsx(Me,{markdown:e})})]})}):null}const cn="_container_dn3w7_1",an="_actions_dn3w7_8",ln="_menuIcon_dn3w7_16",mn="_menuIconOpen_dn3w7_22",dn="_menuButton_dn3w7_27",un="_dropdown_dn3w7_49",pn="_slideIn_dn3w7_1",fn="_dropdownContainer_dn3w7_53",hn="_dropdownInner_dn3w7_65",gn="_dropdownItem_dn3w7_69",B={container:cn,actions:an,menuIcon:ln,menuIconOpen:mn,menuButton:dn,dropdown:un,slideIn:pn,dropdownContainer:fn,dropdownInner:hn,dropdownItem:gn},_n="_buttonGroup_1l8fr_2",Cn="_copyButton_1l8fr_8",Q={buttonGroup:_n,copyButton:Cn},yn=({shareUrl:e})=>{if(!e)return null;const s=async(r,n,c,a)=>{if(!(!n||!r))try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(r);else{const i=document.createElement("textarea");i.value=r,i.style.position="fixed",i.style.left="-999999px",i.style.top="-999999px",document.body.appendChild(i),i.focus(),i.select();try{document.execCommand("copy")}finally{i.remove()}}n.textContent=a,setTimeout(()=>{n.textContent=c},2e3)}catch(i){console.error("Failed to copy:",i),n.textContent="Copy failed",setTimeout(()=>{n.textContent=c},2e3)}},o=r=>{r&&(r.preventDefault(),r.stopPropagation());const n=document.querySelector(`.${Q.shareButton}`);if(!n){console.error("Share button not found");return}s(e,n,"Share","Link copied!")};return t.jsx("div",{className:Q.buttonGroup,children:t.jsx("button",{className:`${Q.copyButton} ${Q.shareButton}`,onClick:o,children:"Share"})})},xn=({afterApply:e,...s})=>{const{sendMessage:o,isLoading:r,response:n,streamingResult:c}=ee("apply_diff_llm","",{transformCompleteResponse:J}),{setResponse:a,config:i,diff:d}=q(),g=ne(c);return m.useEffect(()=>{n&&(a(n),e==null||e())},[n]),d?t.jsx(H,{onClick:()=>o(te(i.botName,"/apply_diff_llm",{},{isCanvas:i.isCanvas})),...s,children:r?g||"Applying diff":"Looks weird? Apply diff using LLM."}):null},vn=({afterApply:e,...s})=>{const{sendMessage:o,isLoading:r,response:n,streamingResult:c}=ee("review","",{transformCompleteResponse:J}),{setResponse:a,config:i,uploadedFiles:d,files:g}=q(),f=ne(c);return m.useEffect(()=>{n&&(a(n),e==null||e())},[n]),!Object.keys(d).length&&!Object.keys(g).length?null:t.jsx(H,{onClick:()=>o(te(i.botName,"/review",{files:d},{isCanvas:i.isCanvas})),...s,children:r?f||"Reviewing the code...":"Code review"})};function jn(){const e=m.useRef(null),[s,o]=m.useState(!1);return m.useEffect(()=>{if(!e.current)return;const r=()=>{var i,d,g;const c=!!((d=(i=e.current)==null?void 0:i.textContent)!=null&&d.trim()),a=((g=e.current)==null?void 0:g.childNodes.length)>0;o(c||a)};r();const n=new MutationObserver(r);return n.observe(e.current,{childList:!0,characterData:!0,subtree:!0}),()=>n.disconnect()},[e.current]),{ref:e,hasContent:s}}const wn=({shareUrl:e})=>{const[s,o]=m.useState(!1),r=m.useRef(null),{config:n}=q(),{ref:c,hasContent:a}=jn();m.useEffect(()=>{const d=g=>{r.current&&!r.current.contains(g.target)&&o(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const i=()=>{o(!1)};return t.jsx("div",{className:B.container,children:t.jsxs("div",{className:B.actions,children:[t.jsx(yn,{shareUrl:e||`https://poe.com/${n.botName}`}),t.jsxs("div",{className:"relative inline-block",ref:r,style:a?{}:{display:"none"},children:[t.jsx(H,{variant:"ghost",size:"small",className:B.menuButton,onClick:()=>o(!s),"aria-expanded":s,children:t.jsxs("svg",{className:`${B.menuIcon} ${s?B.menuIconOpen:""}`,width:"16",height:"16",viewBox:"0 0 16 16",children:[t.jsx("circle",{cx:"8",cy:"4",r:"1.5"}),t.jsx("circle",{cx:"8",cy:"8",r:"1.5"}),t.jsx("circle",{cx:"8",cy:"12",r:"1.5"})]})}),t.jsx("div",{className:`${B.dropdownContainer} ${B.dropdown}`,style:s?{}:{display:"none"},children:t.jsxs("div",{className:B.dropdownInner,ref:c,children:[t.jsx(xn,{className:B.dropdownItem,afterApply:i}),t.jsx(vn,{className:B.dropdownItem,afterApply:i})]})})]})]})})},bn=()=>{const{uploadedFiles:e,setUploadedFiles:s,files:o,diff:r,config:n,description:c,isLoading:a,statusText:i,isInitialData:d}=q(),g=Vt(r),f=Object.keys(o).reduce((l,p)=>(g.includes(p)||(l[p]=o[p]),l),{}),x=async l=>{try{const p=u=>new Promise((w,b)=>{const L=new FileReader;L.onload=()=>w(L.result),L.onerror=b,L.readAsText(u)}),h=await Promise.all(Array.from(l).map(async u=>[u.name,await p(u)]));s(u=>({...u,...Object.fromEntries(h)}))}catch(p){console.error("Error reading files:",p)}},C=l=>{s(p=>{const h={...p};return delete h[l],h})},_=`# 🚀 ${n.botName}
🤯 Tired of AI bots playing hide-and-seek with your code?
Finally! A way to get AI code assistant without the endless "..." or "code continues here" nonsense. Just upload, ask, and get the job done. Simple as that! ⚡️
`;return t.jsxs("div",{className:Gt.container,children:[t.jsx(wn,{shareUrl:d?n.shareUrl:null}),t.jsx(rn,{isVisible:a,text:i}),t.jsx(Zt,{description:n.isInitialPage?_:c}),n.shouldShowUpload&&t.jsx(Ze,{onFilesDrop:x,children:t.jsx(_e,{uploadedFiles:e,size:"large",children:"Send message"})}),t.jsx(Dt,{diff:r,files:o,commentsEnabled:n.shouldShowComments}),Object.keys(f).map(l=>t.jsx(Ce,{filename:l,content:f[l],commentsEnabled:n.shouldShowComments},l)),Object.keys(e).map(l=>t.jsx(Ce,{filename:l,content:e[l],onRemove:()=>C(l),commentsEnabled:n.shouldShowComments},l)),n.shouldShowComments&&t.jsx(en,{children:t.jsx(_e,{uploadedFiles:e,size:"large",children:"Send message"})})]})},Nn=JSON.parse(document.getElementById("config-json-data").textContent),Sn=JSON.parse(document.getElementById("files-json-data").textContent),$n=JSON.parse(document.getElementById("diff-json-data").textContent),Ln=JSON.parse(document.getElementById("comments-json-data").textContent);ae.createRoot(document.getElementById("root")).render(t.jsx(P.StrictMode,{children:t.jsx(it,{initialFiles:Sn,initialComments:Ln,initialDiff:$n,config:Nn,children:t.jsx(bn,{})})}));
