import{r as u,a as Z,R}from"./assets/react-57209f9c.js";import{h as Se,p as de}from"./assets/diff2html-520d79da.js";import{H as Y}from"./assets/hljs-b99628a4.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();var ue={exports:{}},z={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var we=u,Ne=Symbol.for("react.element"),Fe=Symbol.for("react.fragment"),$e=Object.prototype.hasOwnProperty,ke=we.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Re={key:!0,ref:!0,__self:!0,__source:!0};function fe(e,t,r){var s,n={},a=null,c=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(c=t.ref);for(s in t)$e.call(t,s)&&!Re.hasOwnProperty(s)&&(n[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)n[s]===void 0&&(n[s]=t[s]);return{$$typeof:Ne,type:e,key:a,ref:c,props:n,_owner:ke.current}}z.Fragment=Fe;z.jsx=fe;z.jsxs=fe;ue.exports=z;var o=ue.exports,Q={},ae=Z;Q.createRoot=ae.createRoot,Q.hydrateRoot=ae.hydrateRoot;const Le="_container_1kx9n_2",Ee="_uploadZone_1kx9n_10",le={container:Le,uploadZone:Ee},De=({onFilesDrop:e,children:t})=>{const r=c=>{c.preventDefault(),c.currentTarget.style.borderColor="#0969da"},s=c=>{c.currentTarget.style.borderColor="#30363d"},n=c=>{c.preventDefault(),c.currentTarget.style.borderColor="#30363d",e(c.dataTransfer.files)},a=c=>{e(c.target.files),c.target.value=""};return o.jsxs("div",{className:le.container,children:[o.jsxs("div",{className:le.uploadZone,onDragOver:r,onDragLeave:s,onDrop:n,onClick:()=>document.getElementById("fileInput").click(),children:[o.jsx("p",{children:"Drag and drop your source code files here or click to select"}),o.jsx("input",{type:"file",id:"fileInput",style:{display:"none"},multiple:!0,onChange:a})]}),t]})},Be="_button_nc3y6_2",Pe="_small_nc3y6_15",Me="_medium_nc3y6_22",Oe="_large_nc3y6_29",Ie="_primary_nc3y6_47",Ae="_success_nc3y6_56",He="_danger_nc3y6_65",Te="_ghost_nc3y6_75",J={button:Be,small:Pe,medium:Me,large:Oe,default:"_default_nc3y6_37",primary:Ie,success:Ae,danger:He,ghost:Te},ee=({variant:e="default",size:t="medium",disabled:r=!1,type:s="button",onClick:n,children:a,className:c,..._})=>{const C=[J.button,J[e],J[t],c].filter(Boolean).join(" ");return o.jsx("button",{type:s,className:C,onClick:n,disabled:r,..._,children:a})},Ue="_buttonWrapper_17g1b_1",We={buttonWrapper:Ue};`${JSON.stringify({files:{"Store.jsx":`import React, { createContext, useContext, useState, useCallback, useEffect } from 'react';
import { useSendMessage, commandMessageBuilder, cleanupCommandResult } from './poe';
import { normalizeComments, CommentProvider } from './CommentContext';

const StoreContext = createContext(null);

export function StoreProvider({ children, initialFiles, initialComments, initialDiff, config }) {
    const [uploadedFiles, setUploadedFiles] = useState({});

    const [comments, setComments] = useState(initialComments);
    const [globalComment, setGlobalComment] = useState();

    const allComments = normalizeComments(comments, globalComment);

    const { response: result, isLoading, sendMessage } = useSendMessage("store", { files: initialFiles, comments: null, diff: initialDiff });

    const hasUploadedFiles = Boolean(Object.keys(uploadedFiles).length);
    const hasComments = Boolean(allComments.length);

    const sendSubmitMessage = useCallback(() => {
        if (!hasUploadedFiles && !hasComments) {
            return;
        }

        let message = commandMessageBuilder(config.botName, '/set', { files: uploadedFiles });

        if (hasComments) {
            message = commandMessageBuilder(config.botName, '/update', { files: uploadedFiles, comments: allComments });
        }
        sendMessage(message, { transformCompleteResponse: cleanupCommandResult });
    }, [uploadedFiles, allComments, hasUploadedFiles, hasComments]);

    const canSubmitMessage = hasUploadedFiles || hasComments;
    // the comments logic is complicated
    useEffect(() => {
        if (!result.comments) {
            return;
        }

        setComments(result.comments);
    }, [result])

    const value = { config, uploadedFiles, setUploadedFiles, sendSubmitMessage, canSubmitMessage, files: result.files, isLoading, diff: result.diff };

    return (
        <StoreContext.Provider value={value}>
            <CommentProvider setComments={setComments} setGlobalComment={setGlobalComment} globalComment={globalComment} comments={comments} >
                {children}
            </CommentProvider>
        </StoreContext.Provider>
    );
}

export function useStore() {
    const context = useContext(StoreContext);
    return context;
}`},diff:null,comments:null})}`;function pe(e,t,{openChat:r=!1,stream:s=!0,transformCompleteResponse:n=a=>a}={}){const[a,c]=u.useState(t),[_,C]=u.useState(t),[b,y]=u.useState(!1),[f,i]=u.useState(null),[d,p]=u.useState(!1);u.useEffect(()=>{if(!window.Poe){console.info("Poe not found in window object");return}window.Poe.registerHandler(e,m=>{const l=m.responses[0];l.status==="error"?(i(l.statusText),c(t),y(!0),p(!1)):l.status==="incomplete"?(p(!0),C(l.content)):l.status==="complete"&&(p(!1),c(n(l.content)),C(l.content))})},[]);const h=u.useCallback(async m=>{if(m!=null&&m.trim()){p(!0),y(!1),i(null);try{if(console.log(m),!window.Poe){console.info("Poe not found in window object");return}await window.Poe.sendUserMessage(m,{handler:e,stream:s,openChat:r})}catch(l){console.log(l),y(!0),i(l)}}},[e,r,s]);return{sendMessage:h,sendUserMessage:h,response:a,isError:b,error:f,isLoading:d,streamingResult:_}}const V=(e,t,r)=>{const s=`@${e} ${t}`,n=JSON.stringify({...r,format:"json"});return`${s}
~~~
${n}`},X=e=>{console.log(e);const t=e.replace(/\n\n---\n\n\[Logs\]\([^\)]+\)/g,"");return console.log(t),JSON.parse(t)},he=u.createContext(),H="~~~",Ce=(e,t)=>{if(!e)return[];let r=Object.entries(e).map(([s,n])=>{const[a,c]=s.split(H);return{fileName:a,lineInfo:c,comments:n}});return t!=null&&t.content&&(r=[...r,{fileName:"global",lineInfo:"global",comments:[t]}]),r=r.filter(({comments:s})=>s.length),r},ze=({comments:e,setComments:t,globalComment:r,setGlobalComment:s,children:n})=>{const a=(d,p,h)=>{const m=`${d}${H}${p}`,l={id:Date.now(),content:h};t(S=>({...S,[m]:[...S[m]||[],l]}))},c=d=>{const p={id:Date.now(),content:d};s(p)},_=()=>(r==null?void 0:r.content)||"",C=(d,p,h,m)=>{const l=`${d}${H}${p}`;t(S=>({...S,[l]:S[l].map((w,O)=>O===h?{...w,content:m}:w)}))},b=(d,p,h)=>{const m=`${d}${H}${p}`;t(l=>({...l,[m]:l[m].filter((S,w)=>w!==h)}))},y=(d,p)=>{const h=`${d}-${p}`;return e[h]||[]},f=u.useCallback(()=>Ce(e,r),[e,r]),i=u.useCallback(d=>Object.entries(e).filter(([h])=>h.startsWith(`${d}${H}`)).map(([h,m])=>({lineInfo:h.split(H)[1],comments:m})),[e]);return o.jsx(he.Provider,{value:{addComment:a,deleteComment:b,updateComment:C,getComments:y,getAllComments:f,addGlobalComment:c,getGlobalComment:_,getAllCommentsForFile:i},children:n})},te=()=>u.useContext(he),ge=u.createContext(null);function qe({children:e,initialFiles:t,initialComments:r,initialDiff:s,config:n}){const[a,c]=u.useState({}),[_,C]=u.useState(r),[b,y]=u.useState(),f=Ce(_,b),{response:i,isLoading:d,sendMessage:p}=pe("store",{files:t,comments:null,diff:s},{transformCompleteResponse:X}),h=!!Object.keys(a).length,m=!!f.length,l=u.useCallback(()=>{if(!h&&!m)return;let O=V(n.botName,"/set",{files:a});m&&(O=V(n.botName,"/update",{files:a,comments:f})),p(O,{transformCompleteResponse:X})},[a,f,h,m]),S=h||m;u.useEffect(()=>{i.comments&&C(i.comments)},[i]),u.useEffect(()=>{c({})},[i]);const w={config:n,uploadedFiles:a,setUploadedFiles:c,sendSubmitMessage:l,canSubmitMessage:S,files:i.files,isLoading:d,diff:i.diff};return o.jsx(ge.Provider,{value:w,children:o.jsx(ze,{setComments:C,setGlobalComment:y,globalComment:b,comments:_,children:e})})}function _e(){return u.useContext(ge)}JSON.parse(document.getElementById("config-json-data").textContent);const Ge=({uploadedFiles:e,onSubmit:t,children:r,...s})=>{const{sendSubmitMessage:n,canSubmitMessage:a}=_e();return o.jsx("div",{className:We.buttonWrapper,children:o.jsx(ee,{onClick:n,disabled:!a,variant:"success",...s,children:r})})};const Je="_diffContainer_vza99_1",Ke="_fileContent_vza99_3",Ze="_addCommentButton_vza99_23",Ye="_commentRow_vza99_46",Qe="_commentCell_vza99_50",$={diffContainer:Je,fileContent:Ke,"d2h-code-side-emptyplaceholder":"_d2h-code-side-emptyplaceholder_vza99_13","d2h-info":"_d2h-info_vza99_13",addCommentButton:Ze,commentRow:Ye,commentCell:Qe},Ve="_container_1jkch_2",Xe="_header_1jkch_14",et="_buttonGroup_1jkch_25",tt="_content_1jkch_31",nt="_noHeader_1jkch_36",T={container:Ve,header:Xe,buttonGroup:et,content:tt,noHeader:nt},q=({header:e,buttons:t,children:r})=>o.jsxs("div",{className:T.container,children:[e&&o.jsxs("div",{className:T.header,children:[e,o.jsx("div",{className:T.buttonGroup,children:t})]}),o.jsx("div",{className:`${T.content} ${e?"":T.noHeader}`,children:r})]}),ye=async({content:e,onCopySuccess:t,onCopyError:r})=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(e);else{const s=document.createElement("textarea");s.value=e,s.style.top="0",s.style.left="0",s.style.position="fixed",s.style.opacity="0",document.body.appendChild(s),s.focus(),s.select(),document.execCommand("copy"),document.body.removeChild(s)}setCopied(!0),t==null||t(),setTimeout(()=>setCopied(!1),2e3)}catch(s){r==null||r(s)}},xe=({content:e,onCopySuccess:t,onCopyError:r,defaultLabel:s="Copy",successLabel:n="Copied!",children:a=s,...c})=>{const[_,C]=u.useState(!1);return o.jsx(ee,{onClick:()=>ye({content:e,onCopySuccess:()=>C(!0)}),...c,children:_?n:a})},ot="_commentSection_1sd2d_1",st="_stickyComment_1sd2d_12",rt="_commentSectionHeader_1sd2d_22",ct="_comment_1sd2d_1",at="_commentList_1sd2d_38",lt="_commentWrapper_1sd2d_44",mt="_deleteComment_1sd2d_50",it="_formHeader_1sd2d_63",dt="_commentContent_1sd2d_68",ut="_commentForm_1sd2d_76",ft="_commentInput_1sd2d_84",pt="_formFooter_1sd2d_95",ht="_submitComment_1sd2d_99",Ct="_closeButton_1sd2d_111",L={commentSection:ot,stickyComment:st,commentSectionHeader:rt,comment:ct,commentList:at,commentWrapper:lt,deleteComment:mt,formHeader:it,commentContent:dt,commentForm:ut,commentInput:ft,formFooter:pt,submitComment:ht,closeButton:Ct},gt=({content:e,onDelete:t})=>o.jsx("div",{className:L.comment,children:o.jsxs("div",{className:L.commentWrapper,children:[o.jsx("div",{className:L.commentContent,children:e}),o.jsx("button",{className:L.deleteComment,onClick:t,children:"Ã—"})]})}),_t=({onSubmit:e})=>{const[t,r]=u.useState(""),s=n=>{n.preventDefault(),t.trim()&&(e(t),r(""))};return o.jsxs("form",{className:L.commentForm,onSubmit:s,children:[o.jsx("textarea",{value:t,onChange:n=>r(n.target.value),placeholder:"Add a comment...",className:L.commentInput}),o.jsx("div",{className:L.formFooter,children:o.jsx("button",{onClick:s,className:L.submitComment,children:"Comment"})})]})},be=({lineNumber:e,comments:t,onAddComment:r,onDeleteComment:s,onClose:n})=>o.jsx(_t,{onSubmit:r}),je=({comments:e,onDeleteComment:t})=>e.length?o.jsx("div",{className:L.commentList,children:e.map((r,s)=>o.jsx(gt,{...r,onDelete:()=>t(s)},s))}):null,yt=JSON.parse(document.getElementById("config-json-data").textContent),ve=({content:e,filename:t,children:r="Deploy",...s})=>{const{sendMessage:n,isLoading:a,response:c}=pe("deploy","",{transformCompleteResponse:X});return t.endsWith(".html")?(R.useEffect(()=>{c&&ye({content:c.url})},[c]),o.jsx(ee,{onClick:()=>n(V(yt.botName,"/deploy",{filename:t})),...s,children:a?"Deploying":"Deploy"})):null},xt={drawFileList:!1,matching:"lines",outputFormat:"line-by-line",highlight:!1,colorScheme:"dark",renderNothingWhenEmpty:!0,rawTemplates:{"generic-wrapper":'<div class="d2h-auto-color-scheme">{{{content}}}</div>',"line-by-line-file-diff":`
            <div id="{{fileHtmlId}}" data-lang="{{file.language}}">
                <div class="d2h-file-list-wrapper">
                    <div class="d2h-file-list-header">
                        <span class="d2h-file-name-wrapper">
                            <span class="d2h-file-name">{{file.fileName}}</span>
                        </span>
                    </div>
                </div>
                <div class="d2h-file-diff">
                    <div class="d2h-code-wrapper">
                        <table class="d2h-diff-table">
                            <tbody class="d2h-diff-tbody">
                                {{{diffs}}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>`}},bt=R.memo(({file:e,fileContent:t,commentsEnabled:r=!0})=>{const s=R.useRef(null),[n,a]=u.useState(null),c=R.useRef(null),[_,C]=u.useState([]),{addComment:b,deleteComment:y,getComments:f,getAllCommentsForFile:i}=te(),d=u.useMemo(()=>({__html:Se([e],xt)}),[e]),p=u.useCallback(()=>{if(!s.current)return;(()=>{s.current.querySelectorAll(`.${$.commentRow}`).forEach(x=>{x!==c.current&&x.remove()})})();const G=i(e.newName).reduce((g,{lineInfo:x,comments:D})=>(g[x]=D,g),{}),I=[],N={};s.current.querySelectorAll(".d2h-code-linenumber").forEach(g=>{var B,F,j,P,v,M;const x=(j=(F=(B=g.querySelector(".line-num1"))==null?void 0:B.textContent)==null?void 0:F.trim)==null?void 0:j.call(F),A=((M=(v=(P=g.querySelector(".line-num2"))==null?void 0:P.textContent)==null?void 0:v.trim)==null?void 0:M.call(v))||x;N[A]||(N[A]=[]),N[A].push(g)}),Object.entries(N).forEach(([g,x])=>{const D=G[g];if(!(D!=null&&D.length))return;const B=(x[1]?x[1]:x[0]).closest("tr");if(!B)return;const F=B.closest("tbody");if(!F)return;const j=document.createElement("tr");j.className=`${$.commentRow}`,j.setAttribute("data-line",g);const P=document.createElement("div");P.className="portal-container";const v=document.createElement("td");v.className=`${$.commentCell}`,v.colSpan=3,v.appendChild(P),j.appendChild(v),B.nextSibling?F.insertBefore(j,B.nextSibling):F.appendChild(j),I.push(o.jsx(R.Fragment,{children:Z.createPortal(o.jsx(je,{comments:D,onDeleteComment:M=>y(e.newName,g,M)}),P)},`${e.newName}-${g}`))}),C(I)},[e.newName,i,y]);R.useEffect(()=>{setTimeout(async()=>{var E;if(s.current){const ne=s.current.querySelectorAll(".d2h-code-linenumber"),G=((E=e.newName)==null?void 0:E.split(".").pop())||"";ne.forEach(N=>{const g=N.closest("tr");if(!g.classList.contains("d2h-del")&&r){const x=document.createElement("button");x.className=$.addCommentButton,x.innerHTML="+",g.appendChild(x),g.addEventListener("mouseenter",()=>{x.style.opacity="1"}),g.addEventListener("mouseleave",()=>{x.style.opacity="0"}),x.addEventListener("click",D=>{var M,U,oe,se,W,re;const A=(oe=(U=(M=N.querySelector(".line-num1"))==null?void 0:M.textContent)==null?void 0:U.trim)==null?void 0:oe.call(U),F=((re=(W=(se=N.querySelector(".line-num2"))==null?void 0:se.textContent)==null?void 0:W.trim)==null?void 0:re.call(W))||A;if(n===F)return;c.current&&(c.current.remove(),c.current=null),a(F);const j=document.createElement("tr");j.className=$.commentRow,j.innerHTML=`<td colspan="3" class="${$.commentCell}"></td>`;const P=`.${$.commentRow}[data-line="${F}"]`,v=Array.from(s.current.querySelectorAll(P));if(v.length>0){const ce=v[v.length-1];ce.parentNode.insertBefore(j,ce.nextSibling)}else g.parentNode.insertBefore(j,g.nextSibling);c.current=j})}});const I=s.current.querySelectorAll(".d2h-code-line-ctn");I==null||I.forEach(N=>{N.dataset.highlighted||(Y.configure({ignoreUnescapedHTML:!0}),N.classList.add(`language-${G}`),Y.highlightElement(N))})}},0)},[d,e.newName,r,n]),R.useEffect(()=>{p()},[p]);const h=E=>{n&&(b(e.newName,n,E),p())},m=E=>{y(e.newName,n,E),p()},l=()=>{c.current&&(c.current.remove(),c.current=null),a(null)},S=e.isNew?e.newName:e.oldName,w=e.isRename?`${e.oldName} -> ${e.newName}`:S,O=o.jsxs(o.Fragment,{children:[o.jsx(ve,{size:"small",filename:e.newName}),o.jsx(xe,{size:"small",content:t})]});return o.jsx(q,{header:w,buttons:O,children:o.jsxs("div",{className:$.diffContainer,children:[o.jsx("div",{className:$.fileContent,ref:s,dangerouslySetInnerHTML:d}),_,r&&n&&c.current&&Z.createPortal(o.jsx(be,{lineNumber:n,comments:f(e.newName,n),onAddComment:h,onDeleteComment:m,onClose:l}),c.current.querySelector(`.${$.commentCell}`))]})})}),jt=({diff:e,files:t,commentsEnabled:r=!0})=>e?u.useMemo(()=>de(e),[e]).map(n=>o.jsx(bt,{file:n,fileContent:t[n.newName],commentsEnabled:r},n.newName)):null;const vt="_container_1mk1f_1",St="_codeWrapper_1mk1f_7",wt="_inlineCommentSection_1mk1f_16",Nt="_codeLine_1mk1f_21",Ft="_lineNumber_1mk1f_35",$t="_hoverable_1mk1f_48",kt="_lineContent_1mk1f_57",Rt="_addCommentButton_1mk1f_61",k={container:vt,codeWrapper:St,inlineCommentSection:wt,codeLine:Nt,lineNumber:Ft,hoverable:$t,lineContent:kt,addCommentButton:Rt},Lt=e=>{const t=e.split(".").pop().toLowerCase();return{js:"javascript",jsx:"javascript",ts:"typescript",tsx:"typescript",py:"python",rb:"ruby",java:"java",cpp:"cpp",c:"c",cs:"csharp",html:"html",css:"css",scss:"scss",sass:"scss",php:"php",go:"go",rs:"rust",swift:"swift",kt:"kotlin",md:"markdown",json:"json",xml:"xml",yaml:"yaml",yml:"yaml",sql:"sql",sh:"bash",bash:"bash",dockerfile:"dockerfile"}[t]||"plaintext"},Et=({lineNumber:e,content:t,commentsEnabled:r,onLineSelect:s,language:n,selectedLine:a,existingComments:c,onAddComment:_,onDeleteComment:C,onClose:b})=>{const[y,f]=u.useState(!1),i=u.useRef(null);return u.useEffect(()=>{!i.current||i.current.dataset.highlighted==="yes"||Y.highlightElement(i.current)},[t]),o.jsxs("div",{className:k.lineContainer,children:[o.jsxs("div",{className:k.codeLine,"data-line":e,onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),onClick:()=>s(e),children:[o.jsx("span",{className:`${k.lineNumber}${r?" "+k.hoverable:""}`,children:String(e).padStart(3)}),o.jsx("span",{ref:i,className:`${k.lineContent} language-${n}`,children:t}),r&&o.jsx("button",{className:k.addCommentButton,style:{opacity:y?1:0},onClick:d=>{d.stopPropagation(),s(e)},children:"+"})]}),c&&c.length>0&&o.jsx("div",{className:k.existingComments,children:o.jsx(je,{comments:c,onDeleteComment:d=>C(d)})}),a===e&&r&&o.jsx(be,{lineNumber:e,comments:c||[],onAddComment:_,onDeleteComment:C,onClose:b})]})},me=({filename:e,content:t,commentsEnabled:r=!0})=>{const[s,n]=u.useState(null),{addComment:a,deleteComment:c,getAllCommentsForFile:_}=te(),C=Lt(e),b=t.split(`
`),y=o.jsxs(o.Fragment,{children:[o.jsx(ve,{size:"small",filename:e}),o.jsx(xe,{size:"small",content:t})]}),i=_(e).reduce((h,{lineInfo:m,comments:l})=>(h[m]=l,h),{}),d=(h,m)=>{a(e,h,m)},p=(h,m)=>{c(e,h,m)};return o.jsx(q,{header:e,buttons:y,children:o.jsx("div",{className:k.container,children:o.jsx("pre",{className:k.codeWrapper,children:o.jsx("code",{className:`language-${C}`,children:b.map((h,m)=>{const l=m+1,S=i[l]||[];return o.jsx(Et,{lineNumber:l,content:h,commentsEnabled:r,onLineSelect:n,language:C,selectedLine:s,existingComments:S,onAddComment:w=>d(l,w),onDeleteComment:w=>p(l,w),onClose:()=>n(null)},l)})})})})})},Dt="_container_7qw4f_2",Bt={container:Dt},Pt="_diffDescription_guii0_2",Mt={diffDescription:Pt},ie=({description:e})=>e?o.jsx(q,{children:o.jsx("div",{className:Mt.diffDescription,children:e})}):null;function Ot(e){return e?de(e).map(t=>t.newName):[]}const It="_container_r5p9y_1",At="_commentForm_r5p9y_7",Ht="_commentInput_r5p9y_11",K={container:It,commentForm:At,commentInput:Ht},Tt=()=>{const{addGlobalComment:e,getGlobalComment:t}=te(),[r,s]=u.useState(t()),n=a=>{const c=a.target.value;s(c),e(c)};return o.jsx(q,{header:"Comment",children:o.jsx("div",{className:K.container,children:o.jsx("div",{className:K.commentForm,children:o.jsx("textarea",{value:r,onChange:n,placeholder:"What would you like to do?",className:K.commentInput})})})})},Ut=()=>{const{uploadedFiles:e,setUploadedFiles:t,files:r,diff:s,config:n}=_e(),a=Ot(s),c=Object.keys(r).reduce((f,i)=>(a.includes(i)||(f[i]=r[i]),f),{}),_=async f=>{try{const i=p=>new Promise((h,m)=>{const l=new FileReader;l.onload=()=>h(l.result),l.onerror=m,l.readAsText(p)}),d=await Promise.all(Array.from(f).map(async p=>[p.name,await i(p)]));t(p=>({...p,...Object.fromEntries(d)}))}catch(i){console.error("Error reading files:",i)}},C=async()=>{const f=JSON.stringify({files:e}),d=`${`@${n.botName} /set`}
~~~
${f}`;console.log("Message:",d),window.Poe&&await window.Poe.sendUserMessage(d)};R.useEffect(()=>{n.shouldAutoSubmitUpload&&Object.keys(e).length>0&&C()},[e]);const b=f=>{t(i=>{const d={...i};return delete d[f],d})},y=()=>o.jsxs(o.Fragment,{children:[o.jsxs("h1",{children:["ðŸš€ ",n.botName]}),o.jsx("p",{children:"ðŸ¤¯ Tired of AI bots playing hide-and-seek with your code?"}),o.jsx("p",{children:'Finally! A way to get AI code assistant without the endless "..." or "code continues here" nonsense. Just upload, ask, and get the job done. Simple as that! âš¡ï¸'})]});return o.jsxs("div",{className:Bt.container,children:[n.isInitialPage&&o.jsx(ie,{description:o.jsx(y,{})}),o.jsx(ie,{description:n.description}),n.shouldShowUpload&&o.jsx(De,{onFilesDrop:_}),o.jsx(jt,{diff:s,files:r,commentsEnabled:n.shouldShowComments}),Object.keys(c).map(f=>o.jsx(me,{filename:f,content:c[f],commentsEnabled:n.shouldShowComments},f)),Object.keys(e).map(f=>o.jsx(me,{filename:f,content:e[f],onRemove:()=>b(f),commentsEnabled:n.shouldShowComments},f)),n.shouldShowComments&&o.jsx(Tt,{}),o.jsx(Ge,{uploadedFiles:e,size:"large",children:"Send message"})]})},Wt=JSON.parse(document.getElementById("config-json-data").textContent),zt=JSON.parse(document.getElementById("files-json-data").textContent),qt=JSON.parse(document.getElementById("diff-json-data").textContent),Gt=JSON.parse(document.getElementById("comments-json-data").textContent);Q.createRoot(document.getElementById("root")).render(o.jsx(R.StrictMode,{children:o.jsx(qe,{initialFiles:zt,initialComments:Gt,initialDiff:qt,config:Wt,children:o.jsx(Ut,{})})}));
