import{r as h,a as Q,R as I}from"./assets/react-57209f9c.js";import{h as je,p as pe}from"./assets/diff2html-520d79da.js";import{H as X}from"./assets/hljs-b99628a4.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();var fe={exports:{}},z={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var be=h,ve=Symbol.for("react.element"),Ne=Symbol.for("react.fragment"),we=Object.prototype.hasOwnProperty,Se=be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$e={key:!0,ref:!0,__self:!0,__source:!0};function he(e,o,r){var s,n={},a=null,c=null;r!==void 0&&(a=""+r),o.key!==void 0&&(a=""+o.key),o.ref!==void 0&&(c=o.ref);for(s in o)we.call(o,s)&&!$e.hasOwnProperty(s)&&(n[s]=o[s]);if(e&&e.defaultProps)for(s in o=e.defaultProps,o)n[s]===void 0&&(n[s]=o[s]);return{$$typeof:ve,type:e,key:a,ref:c,props:n,_owner:Se.current}}z.Fragment=Ne;z.jsx=he;z.jsxs=he;fe.exports=z;var t=fe.exports,ee={},ae=Q;ee.createRoot=ae.createRoot,ee.hydrateRoot=ae.hydrateRoot;const ke="_container_1kx9n_2",Fe="_uploadZone_1kx9n_10",me={container:ke,uploadZone:Fe},De=({onFilesDrop:e,children:o})=>{const r=c=>{c.preventDefault(),c.currentTarget.style.borderColor="#0969da"},s=c=>{c.currentTarget.style.borderColor="#30363d"},n=c=>{c.preventDefault(),c.currentTarget.style.borderColor="#30363d",e(c.dataTransfer.files)},a=c=>{e(c.target.files),c.target.value=""};return t.jsxs("div",{className:me.container,children:[t.jsxs("div",{className:me.uploadZone,onDragOver:r,onDragLeave:s,onDrop:n,onClick:()=>document.getElementById("fileInput").click(),children:[t.jsx("p",{children:"Drag and drop your source code files here or click to select"}),t.jsx("input",{type:"file",id:"fileInput",style:{display:"none"},multiple:!0,onChange:a})]}),o]})},Le="_button_nc3y6_2",Re="_small_nc3y6_15",Be="_medium_nc3y6_22",Oe="_large_nc3y6_29",Ee="_primary_nc3y6_47",Ie="_success_nc3y6_56",Ae="_danger_nc3y6_65",Pe="_ghost_nc3y6_75",Z={button:Le,small:Re,medium:Be,large:Oe,default:"_default_nc3y6_37",primary:Ee,success:Ie,danger:Ae,ghost:Pe},te=({variant:e="default",size:o="medium",disabled:r=!1,type:s="button",onClick:n,children:a,className:c,..._})=>{const m=[Z.button,Z[e],Z[o],c].filter(Boolean).join(" ");return t.jsx("button",{type:s,className:m,onClick:n,disabled:r,..._,children:a})},He="_buttonWrapper_17g1b_1",Te={buttonWrapper:He},_e=h.createContext(),M="~~~",Me=({initialComments:e,children:o})=>{const[r,s]=h.useState(e),[n,a]=h.useState(),c=(i,d,u)=>{const f=`${i}${M}${d}`,j={id:Date.now(),content:u};s(w=>({...w,[f]:[...w[f]||[],j]}))},_=i=>{const d={id:Date.now(),content:i};a(d)},m=()=>(n==null?void 0:n.content)||"",p=(i,d,u,f)=>{const j=`${i}${M}${d}`;s(w=>({...w,[j]:w[j].map((P,k)=>k===u?{...P,content:f}:P)}))},l=(i,d,u)=>{const f=`${i}${M}${d}`;s(j=>({...j,[f]:j[f].filter((w,P)=>P!==u)}))},g=(i,d)=>{const u=`${i}-${d}`;return r[u]||[]},y=h.useCallback(()=>{const i=Object.entries(r).map(([d,u])=>{const[f,j]=d.split(M);return{fileName:f,lineInfo:j,comments:u}});return n!=null&&n.content?[...i,{fileName:"global",lineInfo:"global",comments:[n]}]:i},[r,n]),N=h.useCallback(i=>Object.entries(r).filter(([u])=>u.startsWith(`${i}${M}`)).map(([u,f])=>({lineInfo:u.split(M)[1],comments:f})),[r]);return t.jsx(_e.Provider,{value:{addComment:c,deleteComment:l,updateComment:p,getComments:g,getAllComments:y,addGlobalComment:_,getGlobalComment:m,getAllCommentsForFile:N},children:o})},G=()=>h.useContext(_e),le=JSON.parse(document.getElementById("config-json-data").textContent),We=()=>{window.scrollTo({top:0,behavior:"smooth"})},qe=({uploadedFiles:e,onSubmit:o,children:r,...s})=>{const{getAllComments:n}=G(),a=n(),c=!!Object.keys(e).length,_=!!a.length,m=async()=>{let l=`@${le.botName} /update`,g=JSON.stringify({files:e,comments:a}),y=`${l}
~~~
${g}`;c&&!_&&(l=`@${le.botName} /set`,g=JSON.stringify({files:e}),y=`${l}
~~~
${g}`),console.log("Message",y),We(),window.Poe&&await window.Poe.sendUserMessage(y)},p=!c&&!_;return t.jsx("div",{className:Te.buttonWrapper,children:t.jsx(te,{onClick:m,disabled:!!p,variant:"success",...s,children:r})})};const Je="_diffContainer_vza99_1",ze="_fileContent_vza99_3",Ge="_addCommentButton_vza99_23",Ue="_commentRow_vza99_46",Ke="_commentCell_vza99_50",F={diffContainer:Je,fileContent:ze,"d2h-code-side-emptyplaceholder":"_d2h-code-side-emptyplaceholder_vza99_13","d2h-info":"_d2h-info_vza99_13",addCommentButton:Ge,commentRow:Ue,commentCell:Ke},Ze="_container_1jkch_2",Ve="_header_1jkch_14",Ye="_buttonGroup_1jkch_25",Qe="_content_1jkch_31",Xe="_noHeader_1jkch_36",W={container:Ze,header:Ve,buttonGroup:Ye,content:Qe,noHeader:Xe},U=({header:e,buttons:o,children:r})=>t.jsxs("div",{className:W.container,children:[e&&t.jsxs("div",{className:W.header,children:[e,t.jsx("div",{className:W.buttonGroup,children:o})]}),t.jsx("div",{className:`${W.content} ${e?"":W.noHeader}`,children:r})]}),Ce=({content:e,onCopySuccess:o,onCopyError:r,defaultLabel:s="Copy",successLabel:n="Copied!",children:a=s,...c})=>{const[_,m]=h.useState(!1),p=async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(e);else{const l=document.createElement("textarea");l.value=e,l.style.top="0",l.style.left="0",l.style.position="fixed",l.style.opacity="0",document.body.appendChild(l),l.focus(),l.select(),document.execCommand("copy"),document.body.removeChild(l)}m(!0),o==null||o(),setTimeout(()=>m(!1),2e3)}catch(l){r==null||r(l)}};return t.jsx(te,{onClick:p,...c,children:_?n:a})},et="_commentSection_1sd2d_1",tt="_stickyComment_1sd2d_12",nt="_commentSectionHeader_1sd2d_22",ot="_comment_1sd2d_1",st="_commentList_1sd2d_38",ct="_commentWrapper_1sd2d_44",rt="_deleteComment_1sd2d_50",at="_formHeader_1sd2d_63",mt="_commentContent_1sd2d_68",lt="_commentForm_1sd2d_76",it="_commentInput_1sd2d_84",dt="_formFooter_1sd2d_95",ut="_submitComment_1sd2d_99",pt="_closeButton_1sd2d_111",R={commentSection:et,stickyComment:tt,commentSectionHeader:nt,comment:ot,commentList:st,commentWrapper:ct,deleteComment:rt,formHeader:at,commentContent:mt,commentForm:lt,commentInput:it,formFooter:dt,submitComment:ut,closeButton:pt},ft=({content:e,onDelete:o})=>t.jsx("div",{className:R.comment,children:t.jsxs("div",{className:R.commentWrapper,children:[t.jsx("div",{className:R.commentContent,children:e}),t.jsx("button",{className:R.deleteComment,onClick:o,children:"×"})]})}),ht=({onSubmit:e})=>{const[o,r]=h.useState(""),s=n=>{n.preventDefault(),o.trim()&&(e(o),r(""))};return t.jsxs("form",{className:R.commentForm,onSubmit:s,children:[t.jsx("textarea",{value:o,onChange:n=>r(n.target.value),placeholder:"Add a comment...",className:R.commentInput}),t.jsx("div",{className:R.formFooter,children:t.jsx("button",{onClick:s,className:R.submitComment,children:"Comment"})})]})},ge=({lineNumber:e,comments:o,onAddComment:r,onDeleteComment:s,onClose:n})=>t.jsx(ht,{onSubmit:r}),ye=({comments:e,onDeleteComment:o})=>e.length?t.jsx("div",{className:R.commentList,children:e.map((r,s)=>t.jsx(ft,{...r,onDelete:()=>o(s)},s))}):null,_t=JSON.parse(document.getElementById("config-json-data").textContent),xe=({content:e,filename:o,children:r="Deploy",...s})=>{const n=async()=>{let a=`@${_t.botName} /deploy`,c=JSON.stringify({filename:o}),_=`${a}
~~~
${c}`;console.log("Message",_),window.Poe&&await window.Poe.sendUserMessage(_)};return o.endsWith(".html")?t.jsx(te,{onClick:n,...s,children:"Deploy"}):null},Ct={drawFileList:!1,matching:"lines",outputFormat:"line-by-line",highlight:!1,colorScheme:"dark",renderNothingWhenEmpty:!0,rawTemplates:{"generic-wrapper":'<div class="d2h-auto-color-scheme">{{{content}}}</div>',"line-by-line-file-diff":`
            <div id="{{fileHtmlId}}" data-lang="{{file.language}}">
                <div class="d2h-file-list-wrapper">
                    <div class="d2h-file-list-header">
                        <span class="d2h-file-name-wrapper">
                            <span class="d2h-file-name">{{file.fileName}}</span>
                        </span>
                    </div>
                </div>
                <div class="d2h-file-diff">
                    <div class="d2h-code-wrapper">
                        <table class="d2h-diff-table">
                            <tbody class="d2h-diff-tbody">
                                {{{diffs}}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>`}},gt=I.memo(({file:e,fileContent:o,commentsEnabled:r=!0})=>{const s=I.useRef(null),[n,a]=h.useState(null),c=I.useRef(null),[_,m]=h.useState([]),{addComment:p,deleteComment:l,getComments:g,getAllCommentsForFile:y}=G(),N=h.useMemo(()=>({__html:je([e],Ct)}),[e]),i=h.useCallback(()=>{if(!s.current)return;(()=>{s.current.querySelectorAll(`.${F.commentRow}`).forEach(x=>{x!==c.current&&x.remove()})})();const K=y(e.newName).reduce((C,{lineInfo:x,comments:B})=>(C[x]=B,C),{}),H=[],S={};s.current.querySelectorAll(".d2h-code-linenumber").forEach(C=>{var O,$,b,E,v,A;const x=(b=($=(O=C.querySelector(".line-num1"))==null?void 0:O.textContent)==null?void 0:$.trim)==null?void 0:b.call($),T=((A=(v=(E=C.querySelector(".line-num2"))==null?void 0:E.textContent)==null?void 0:v.trim)==null?void 0:A.call(v))||x;S[T]||(S[T]=[]),S[T].push(C)}),Object.entries(S).forEach(([C,x])=>{const B=K[C];if(!(B!=null&&B.length))return;const O=(x[1]?x[1]:x[0]).closest("tr");if(!O)return;const $=O.closest("tbody");if(!$)return;const b=document.createElement("tr");b.className=`${F.commentRow}`,b.setAttribute("data-line",C);const E=document.createElement("div");E.className="portal-container";const v=document.createElement("td");v.className=`${F.commentCell}`,v.colSpan=3,v.appendChild(E),b.appendChild(v),O.nextSibling?$.insertBefore(b,O.nextSibling):$.appendChild(b),H.push(t.jsx(I.Fragment,{children:Q.createPortal(t.jsx(ye,{comments:B,onDeleteComment:A=>l(e.newName,C,A)}),E)},`${e.newName}-${C}`))}),m(H)},[e.newName,y,l]);I.useEffect(()=>{setTimeout(async()=>{var k;if(s.current){const ne=s.current.querySelectorAll(".d2h-code-linenumber"),K=((k=e.newName)==null?void 0:k.split(".").pop())||"";ne.forEach(S=>{const C=S.closest("tr");if(!C.classList.contains("d2h-del")&&r){const x=document.createElement("button");x.className=F.addCommentButton,x.innerHTML="+",C.appendChild(x),C.addEventListener("mouseenter",()=>{x.style.opacity="1"}),C.addEventListener("mouseleave",()=>{x.style.opacity="0"}),x.addEventListener("click",B=>{var A,q,oe,se,J,ce;const T=(oe=(q=(A=S.querySelector(".line-num1"))==null?void 0:A.textContent)==null?void 0:q.trim)==null?void 0:oe.call(q),$=((ce=(J=(se=S.querySelector(".line-num2"))==null?void 0:se.textContent)==null?void 0:J.trim)==null?void 0:ce.call(J))||T;if(n===$)return;c.current&&(c.current.remove(),c.current=null),a($);const b=document.createElement("tr");b.className=F.commentRow,b.innerHTML=`<td colspan="3" class="${F.commentCell}"></td>`;const E=`.${F.commentRow}[data-line="${$}"]`,v=Array.from(s.current.querySelectorAll(E));if(v.length>0){const re=v[v.length-1];re.parentNode.insertBefore(b,re.nextSibling)}else C.parentNode.insertBefore(b,C.nextSibling);c.current=b})}});const H=s.current.querySelectorAll(".d2h-code-line-ctn");H==null||H.forEach(S=>{S.dataset.highlighted||(X.configure({ignoreUnescapedHTML:!0}),S.classList.add(`language-${K}`),X.highlightElement(S))})}},0)},[N,e.newName,r,n]),I.useEffect(()=>{i()},[i]);const d=k=>{n&&(p(e.newName,n,k),i())},u=k=>{l(e.newName,n,k),i()},f=()=>{c.current&&(c.current.remove(),c.current=null),a(null)},j=e.isNew?e.newName:e.oldName,w=e.isRename?`${e.oldName} -> ${e.newName}`:j,P=t.jsxs(t.Fragment,{children:[t.jsx(xe,{size:"small",filename:e.newName}),t.jsx(Ce,{size:"small",content:o})]});return t.jsx(U,{header:w,buttons:P,children:t.jsxs("div",{className:F.diffContainer,children:[t.jsx("div",{className:F.fileContent,ref:s,dangerouslySetInnerHTML:N}),_,r&&n&&c.current&&Q.createPortal(t.jsx(ge,{lineNumber:n,comments:g(e.newName,n),onAddComment:d,onDeleteComment:u,onClose:f}),c.current.querySelector(`.${F.commentCell}`))]})})}),yt=({diff:e,files:o,commentsEnabled:r=!0})=>h.useMemo(()=>pe(e),[e]).map(n=>t.jsx(gt,{file:n,fileContent:o[n.newName],commentsEnabled:r},n.newName));const xt="_container_1mk1f_1",jt="_codeWrapper_1mk1f_7",bt="_inlineCommentSection_1mk1f_16",vt="_codeLine_1mk1f_21",Nt="_lineNumber_1mk1f_35",wt="_hoverable_1mk1f_48",St="_lineContent_1mk1f_57",$t="_addCommentButton_1mk1f_61",L={container:xt,codeWrapper:jt,inlineCommentSection:bt,codeLine:vt,lineNumber:Nt,hoverable:wt,lineContent:St,addCommentButton:$t},kt=e=>{const o=e.split(".").pop().toLowerCase();return{js:"javascript",jsx:"javascript",ts:"typescript",tsx:"typescript",py:"python",rb:"ruby",java:"java",cpp:"cpp",c:"c",cs:"csharp",html:"html",css:"css",scss:"scss",sass:"scss",php:"php",go:"go",rs:"rust",swift:"swift",kt:"kotlin",md:"markdown",json:"json",xml:"xml",yaml:"yaml",yml:"yaml",sql:"sql",sh:"bash",bash:"bash",dockerfile:"dockerfile"}[o]||"plaintext"},Ft=({lineNumber:e,content:o,commentsEnabled:r,onLineSelect:s,language:n,selectedLine:a,existingComments:c,onAddComment:_,onDeleteComment:m,onClose:p})=>{const[l,g]=h.useState(!1),y=h.useRef(null);return h.useEffect(()=>{!y.current||y.current.dataset.highlighted==="yes"||X.highlightElement(y.current)},[o]),t.jsxs("div",{className:L.lineContainer,children:[t.jsxs("div",{className:L.codeLine,"data-line":e,onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),onClick:()=>s(e),children:[t.jsx("span",{className:`${L.lineNumber}${r?" "+L.hoverable:""}`,children:String(e).padStart(3)}),t.jsx("span",{ref:y,className:`${L.lineContent} language-${n}`,children:o}),r&&t.jsx("button",{className:L.addCommentButton,style:{opacity:l?1:0},onClick:N=>{N.stopPropagation(),s(e)},children:"+"})]}),c&&c.length>0&&t.jsx("div",{className:L.existingComments,children:t.jsx(ye,{comments:c,onDeleteComment:N=>m(N)})}),a===e&&r&&t.jsx(ge,{lineNumber:e,comments:c||[],onAddComment:_,onDeleteComment:m,onClose:p})]})},ie=({filename:e,content:o,commentsEnabled:r=!0})=>{const[s,n]=h.useState(null),{addComment:a,deleteComment:c,getAllCommentsForFile:_}=G(),m=kt(e),p=o.split(`
`),l=t.jsxs(t.Fragment,{children:[t.jsx(xe,{size:"small",filename:e}),t.jsx(Ce,{size:"small",content:o})]}),y=_(e).reduce((d,{lineInfo:u,comments:f})=>(d[u]=f,d),{}),N=(d,u)=>{a(e,d,u)},i=(d,u)=>{c(e,d,u)};return t.jsx(U,{header:e,buttons:l,children:t.jsx("div",{className:L.container,children:t.jsx("pre",{className:L.codeWrapper,children:t.jsx("code",{className:`language-${m}`,children:p.map((d,u)=>{const f=u+1,j=y[f]||[];return t.jsx(Ft,{lineNumber:f,content:d,commentsEnabled:r,onLineSelect:n,language:m,selectedLine:s,existingComments:j,onAddComment:w=>N(f,w),onDeleteComment:w=>i(f,w),onClose:()=>n(null)},f)})})})})})},Dt="_container_7qw4f_2",Lt={container:Dt},Rt="_diffDescription_guii0_2",Bt={diffDescription:Rt},de=({description:e})=>e?t.jsx(U,{children:t.jsx("div",{className:Bt.diffDescription,children:e})}):null;function Ot(e){return e?pe(e).map(o=>o.newName):[]}const Et="_container_r5p9y_1",It="_commentForm_r5p9y_7",At="_commentInput_r5p9y_11",V={container:Et,commentForm:It,commentInput:At},Pt=()=>{const{addGlobalComment:e,getGlobalComment:o}=G(),[r,s]=h.useState(o()),n=a=>{const c=a.target.value;s(c),e(c)};return t.jsx(U,{header:"Comment",children:t.jsx("div",{className:V.container,children:t.jsx("div",{className:V.commentForm,children:t.jsx("textarea",{value:r,onChange:n,placeholder:"What would you like to do?",className:V.commentInput})})})})},D=JSON.parse(document.getElementById("config-json-data").textContent),Y=JSON.parse(document.getElementById("files-json-data").textContent),ue=JSON.parse(document.getElementById("diff-json-data").textContent),Ht=JSON.parse(document.getElementById("comments-json-data").textContent),Tt=()=>{const[e,o]=h.useState({}),r=Ot(ue),s=Object.keys(Y).reduce((m,p)=>(r.includes(p)||(m[p]=Y[p]),m),{}),n=async m=>{try{const p=g=>new Promise((y,N)=>{const i=new FileReader;i.onload=()=>y(i.result),i.onerror=N,i.readAsText(g)}),l=await Promise.all(Array.from(m).map(async g=>[g.name,await p(g)]));o(g=>({...g,...Object.fromEntries(l)}))}catch(p){console.error("Error reading files:",p)}},a=async()=>{const m=JSON.stringify({files:e}),l=`${`@${D.botName} /set`}
~~~
${m}`;console.log("Message:",l),window.Poe&&await window.Poe.sendUserMessage(l)};I.useEffect(()=>{D.shouldAutoSubmitUpload&&Object.keys(e).length>0&&a()},[e]);const c=m=>{o(p=>{const l={...p};return delete l[m],l})},_=()=>t.jsxs(t.Fragment,{children:[t.jsxs("h1",{children:["🚀 ",D.botName]}),t.jsx("p",{children:"🤯 Tired of AI bots playing hide-and-seek with your code?"}),t.jsx("p",{children:'Finally! A way to get AI code assistant without the endless "..." or "code continues here" nonsense. Just upload, ask, and get the job done. Simple as that! ⚡️'})]});return t.jsx(Me,{initialComments:Ht,children:t.jsxs("div",{className:Lt.container,children:[D.isInitialPage&&t.jsx(de,{description:t.jsx(_,{})}),t.jsx(de,{description:D.description}),D.shouldShowUpload&&t.jsx(De,{onFilesDrop:n}),t.jsx(yt,{diff:ue,files:Y,commentsEnabled:D.shouldShowComments}),Object.keys(s).map(m=>t.jsx(ie,{filename:m,content:s[m],commentsEnabled:D.shouldShowComments},m)),Object.keys(e).map(m=>t.jsx(ie,{filename:m,content:e[m],onRemove:()=>c(m),commentsEnabled:D.shouldShowComments},m)),D.shouldShowComments&&t.jsx(Pt,{}),t.jsx(qe,{uploadedFiles:e,size:"large",children:"Send message"})]})})};ee.createRoot(document.getElementById("root")).render(t.jsx(I.StrictMode,{children:t.jsx(Tt,{})}));
